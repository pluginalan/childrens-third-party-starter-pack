/*!
* Echo - v9.0.0, 2017-04-07, from git revision ef02a7fe3d56d987b471070b0d2abe5c944aafaf.
* Copyright (c) 2017 BBC, all rights reserved.
*
* Copyright (c) 2014 comScore, Inc.
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.echo_js=t():e.echo_js=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=30)}([function(e,t,n){var i;i=function(e){"use strict";function t(e,t,n,i){var s={};return s[r.COMSCORE_CUSTOMER_ID]=e,s[r.COMSCORE_SITE]=t,s[r.COMSCORE_HOST]=n,s[r.SSC_HOSTNAME]=i,s}function i(e){return t(o.PUBLIC_SERVICE,e,"sa.bbc.co.uk",".co.uk")}function s(e,n){return t(e,n,"scorecardresearch.com",".com")}var r=n(3),o={PUBLIC_SERVICE:"16060501",GNL:"19293874",WORLD_SERVICE:"19999701",WORLDWIDE_FEATURES:"19774467",STORE_NONCOMMERCIAL:"19774474",STORE_COMMERCIAL:"19774472",AFFILIATES_ACCEPTANCE:"18897612",BRITBOX:"23239715",BRITBOX_ACCEPTANCE:"18897612"},a={};a.PUBLIC_SERVICE=i("bbc"),a.PUBLIC_SERVICE_STAGE=i("stage"),a.PUBLIC_SERVICE_TEST=i("test"),a.PUBLIC_SERVICE_INT=i("int"),a.PUBLIC_SERVICE_INTRANET=i("intranet"),a.GNL=s(o.GNL,"bbc"),a.GNL_ACCEPTANCE=s(o.AFFILIATES_ACCEPTANCE,"gnl-test"),a.WORLD_SERVICE=s(o.WORLD_SERVICE,"bbc"),a.WORLD_SERVICE_ACCEPTANCE=s(o.AFFILIATES_ACCEPTANCE,"ws-test"),a.WORLDWIDE_FEATURES=s(o.WORLDWIDE_FEATURES,"bbc"),a.WORLDWIDE_FEATURES_ACCEPTANCE=s(o.AFFILIATES_ACCEPTANCE,"features-test"),a.STORE_NONCOMMERCIAL=s(o.STORE_NONCOMMERCIAL,"bbc"),a.STORE_COMMERCIAL=s(o.STORE_COMMERCIAL,"bbc"),a.BRITBOX_ACCEPTANCE=s(o.BRITBOX_ACCEPTANCE,"bbc-global-test"),a.BRITBOX=s(o.BRITBOX,"bbc");var u={ApplicationType:{WEB:"web",MOBILE_WEB:"mobile-web",RESPONSIVE:"responsive",MOBILE_APP:"mobile-app",BIGSCREEN_HTML:"bigscreen-html",BIGSCREEN_FLASH:"bigscreen-flash",BIGSCREEN_APP:"bigscreen-app",BIGSCREEN_CAST:"bigscreen-cast"},WindowState:{FULL:"full",NORMAL:"norm",MINIMISED:"min",MAXIMISED:"max",PICTUREINPICTURE:"picture-in-picture"},MediaIdType:{VERSION:"version",CLIP:"clip",EPISODE:"episode",SERVICE:"service",VPID:"vpid"},AvType:{AUDIO:"audio",VIDEO:"video"},RetrievalType:{STREAM:"stream",DOWNLOAD:"download"},Form:{LONG:"long",SHORT:"short"},PIPsType:{CLIP:"clip",EPISODE:"ep"},MediaConsumptionMode:{ON_DEMAND:"ondemand",LIVE:"live",DOWNLOAD:"download"},EchoScheduleMode:{ON:"on",OFF:"off"},ManagedLabels:{EVENT_MASTER_BRAND:"event_master_brand",BBC_SITE:"bbc_site",IPLAYER_STATE:"iplayer_state",STORE_ED_TYPE:"store_ed_type",IPLAYER_AVAIL:"iplayer_avail",STORE_REFERRAL:"store_referral",BBC_HASHED_ID:"bbc_hid"},ReportingProfiles:a,EssError:{STATUS_CODE:"status_code",TIMEOUT:"timeout",JSON:"json",RUNTIME:"runtime_error"}};return u}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(e){"use strict";function t(e){var n={};for(var i in e)try{e[i].constructor===Object?n[i]=t(e[i]):n[i]=e[i]}catch(t){n[i]=e[i]}return n}function i(e,n,s){var r=s?e:t(e);for(var o in n)try{n[o].constructor===Object?r[o]=i(r[o],n[o]):r[o]=n[o]}catch(e){r[o]=n[o]}return r}function s(e,t){for(var n in e)if(e.hasOwnProperty(n)&&e[n]===t)return!0;return!1}function r(e,n){for(var s=(n?t(e):e)||{},r=arguments,o=2,a=r.length;o<a;o++)"object"==typeof r[o]?i(s,r[o],!0):s[r[o]]=r[++o];return s}function o(e,t,n){return n?r(e,!0,t,n):r(e,!0,t)}function a(e,t,n){return e||(n?l.warn("AssertionFailed: "+t):l.error("AssertionFailed: "+t)),e}function u(e,t,n){return a(s(e,t),n)}function c(e){if("string"==typeof e)return e=String.prototype.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}var l=n(2);return{clone:t,combineObjects:i,addKV:o,containsValue:s,extend:r,assert:a,assertContainsValue:u,trim:c}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(e){"use strict";function t(e,t){"object"==typeof console&&"function"==typeof console[e]&&console[e](t)}function n(){o=!0}function i(){o=!1}function s(e){o&&t("log",e)}function r(e){if(o)throw new Error("ECHO_DEBUG: "+e)}var o=!1;return{enable:n,disable:i,info:s,warn:s,error:r}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){"use strict";var e={ECHO_ENABLED:"enabled",ECHO_TRACE:"trace",ECHO_DEVICE_ID:"device_id",ECHO_NAME:"lib_name",ECHO_VERSION:"lib_version",USE_SSC:"use_ssc",SSC_HOSTNAME:"ssc_hostname",REPORTING_PROFILE:"reporting_profile",COMSCORE_ENABLED:"comscore.enabled",COMSCORE_HOST:"comscore.host",COMSCORE_SITE:"comscore.site",COMSCORE_CUSTOMER_ID:"comscore.customer_id",COMSCORE_PUBLISHER_SECRET:"comscore.publisher_secret",TEST_SERVICE_ENABLED:"test.enabled",TEST_SERVICE_URL:"test.url",BARB_ENABLED:"barb.enabled",BARB_SITE_CODE:"barb.site_code",BARB_DEBUG:"barb.debug",USE_ESS:"use_ess",ESS_HOSTNAME:"ess.hostname"};return e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){!(e.exports={BBC_APPLICATION_NAME:"app_name",BBC_APPLICATION_TYPE:"app_type",BBC_APPLICATION_VERSION:"app_version",BBC_COUNTER_NAME:"name",BBC_LANGUAGE:"language",DEVICE_ID:"ns_alias",COMSCORE_C1:"c1",BBC_MEASUREMENT_LIB_NAME:"ml_name",BBC_MEASUREMENT_LIB_VERSION:"ml_version",ECHO_TRACE:"trace",ECHO_EVENT_NAME:"echo_event",EVENT_TRIGGERED_BY_USER:"ns_st_ui",STREAMSENSE_CUSTOM_EVENT_TYPE:"ns_st_ev",USER_ACTION_TYPE:"action_type",USER_ACTION_NAME:"action_name",PLAYLIST_END:"ns_st_pe",REWIND_FF_RATE:"ffrw_rate",COMSCORE_SITE:"ns_site",COMSCORE_CUSTOMER:"c2",COMSCORE_ENDPOINT:"comscore_endpoint",PLAYER_NAME:"ns_st_mp",PLAYER_VERSION:"ns_st_mv",PLAYER_WINDOW_STATE:"ns_st_ws",PLAYER_VOLUME:"ns_st_vo",PLAYER_POPPED:"bbc_st_pop",PLAYER_SUBTITLED:"bbc_st_sub",PLAYLIST_NAME:"ns_st_pl",PLAYLIST_CLIP_COUNT:"ns_st_cp",PLAYLIST_LENGTH:"ns_st_ca",MEDIA_PID:"ns_st_ci",MEDIA_LENGTH:"ns_st_cl",MEDIA_BITRATE:"ns_st_br",MEDIA_STREAM_TYPE:"ns_st_ty",MEDIA_IS_LIVE:"ns_st_li",MEDIA_EPISODE_ID:"episode_id",MEDIA_CLIP_ID:"clip_id",MEDIA_CLIP_NUMBER:"ns_st_cn",MEDIA_PART_NUMBER:"ns_st_pn",MEDIA_TOTAL_PARTS:"ns_st_tp",MEDIA_MEDIUM:"bbc_st_med",MEDIA_LIVE_OR_ONDEMAND:"bbc_st_lod",MEDIA_FORM:"bbc_st_mf",MEDIA_RETRIEVAL_TYPE:"bbc_st_ret",MEDIA_SCHEDULE_INDICATOR:"bbc_st_sch",MEDIA_CODEC:"bbc_st_co",MEDIA_CDN:"bbc_st_cdn",MEDIA_VERSION_ID:"version_id",MEDIA_SERVICE_ID:"service_id",MEDIA_AMBIGUOUS_ID:"ambig_ci",MEDIA_TIMESTAMP:"bbc_st_live_ts",ESS_SUCCESS:"ess_success",ESS_ERROR:"ess_error",ESS_STATUS_CODE:"ess_status_code",APP_PLATFORM_NAME:"ns_ap_pn",APP_PLATFORM_RUNTIME:"ns_ap_pfm",APP_OS_VERSION:"ns_ap_pfv",APP_DEVICE_NAME:"ns_ap_device",APP_SCREEN_RESOLUTION:"ns_ap_res",APP_LANGUAGE:"ns_ap_lang",ENV_CHAR_SET:"ns_c",ENV_TITLE:"c8",ENV_URL:"c7",ENV_REFERRER:"c9",APP_NAME:"ns_ap_an",APP_VERSION:"ns_ap_ver",NO_COOKIES:"ns_nc",COOKIE_POLICY:"bbc_mc",BBC_ID_LOGGED_IN:"bbc_identity",WEB_SCREEN_RES:"screen_resolution",ESS_ENABLED:"ess_enabled",ESS_ENRICHED:"ess_enriched"})},function(e,t,n){var i;i=function(e){"use strict";function t(){var e=window.screen||{},t=window.navigator||{},n=window.document||{};this._platformRuntimeEnvironment="html",this._platformOSVersion="5",this._screenResolution=(e.width||"-")+"x"+(e.height||"-"),this._language=t.language||"",this._platformName=t.platform||"",this._charset=n.characterSet||n.defaultCharset||"",this._title=n.title||"",this._url=n.URL||"",this._referrer=n.referrer||"",this._deviceName=null,this._httpGet=null,this._executeCrossDomainGet=null,this._getCookie=null,this._setCookie=null,this._setLocalStorageItem=null,this._getLocalStorageItem=null}var i=n(6),s=n(12),r=n(29);t._defaultHttpGet=r.httpGet,t._defaultGetCookie=s.getCookieValueByName,t.prototype.getPlatformName=function(){return this._platformName},t.prototype.getPlatformRuntimeEnvironment=function(){return this._platformRuntimeEnvironment},t.prototype.getPlatformOSVersion=function(){return this._platformOSVersion},t.prototype.getDeviceName=function(){return this._deviceName},t.prototype.getScreenResolution=function(){return this._screenResolution},t.prototype.getLanguage=function(){return this._language},t.prototype.getHttpGet=function(){return this._httpGet},t.prototype.setExecuteCrossDomainGet=function(e){this._executeCrossDomainGet=e},t.prototype.getExecuteCrossDomainGet=function(){var e;return e=this._executeCrossDomainGet?this._executeCrossDomainGet:r.executeCrossDomainGet},t.prototype.getCookieGetter=function(){return this._getCookie},t.prototype.getCookieSetter=function(){return this._setCookie},t.prototype.getCharSet=function(){return this._charset},t.prototype.getTitle=function(){return this._title},t.prototype.getURL=function(){return this._url},t.prototype.getProtocol=function(){return this.getURL().indexOf("https:",0)===-1?"http:":"https:"},t.prototype.getReferrer=function(){return this._referrer},t.prototype.setSetLocalStorageItem=function(e){this._setLocalStorageItem=e},t.prototype.getSetLocalStorageItem=function(){return this._setLocalStorageItem},t.prototype.setGetLocalStorageItem=function(e){this._getLocalStorageItem=e},t.prototype.getGetLocalStorageItem=function(){return this._getLocalStorageItem},t.prototype.setPlatformName=function(e){return this._platformName=e,this},t.prototype.setPlatform=function(e,t){return this._platformRuntimeEnvironment=e,this._platformOSVersion=t,this},t.prototype.setDeviceName=function(e){return this._deviceName=e,this},t.prototype.setScreenResolution=function(e){return this._screenResolution=e,this},t.prototype.setLanguage=function(e){return this._language=i.cleanLanguage(e),this},t.prototype.setHttpGet=function(e){return this._httpGet=e,this},t.prototype.setCookieGetter=function(e){return this._getCookie=e,this},t.prototype.setCookieSetter=function(e){return this._setCookie=e,this},t.prototype.setCharSet=function(e){return this._charset=e,this},t.prototype.setTitle=function(e){return this._title=e,this},t.prototype.setURL=function(e){return this._url=e,this},t.prototype.setReferrer=function(e){return this._referrer=e,this};var o;t.setOrbCookies=function(e){return o=e,this},t.getOrbCookies=function(){return o},t.getOrbCookiesPolicy=function(){if(o&&"function"==typeof o.readPolicy)return o.readPolicy()};var a,u,c=!1,l=[];return t.setOrbIdCta=function(e){return a=e,this},t.getOrbIdCta=function(e){var t,n=function(e,t){e&&"function"==typeof e&&e(t)};if(void 0!==a)return void n(e,a);if(u===!1)return void n(e);l.push(e);var i=window.require;void 0===u&&i?(u="function"==typeof i.defined&&i.defined("idcta/idcta-1"),!u&&i.s&&i.s.contexts&&i.s.contexts._&&i.s.contexts._.config&&i.s.contexts._.config.paths&&i.s.contexts._.config.paths.idcta&&(u=!0)):u=!1,u&&!c?(c=!0,window.require(["idcta/idcta-1"],function(e){for(a=e,t=0;t<l.length;l++)l[t]&&"function"==typeof l[t]&&n(l[t],a)})):u===!1&&n(e)},t}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(e){"use strict";function t(e){return g.hasOwnProperty(e)?g[e]:h.CUSTOM}function i(e){return e&&e.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/(^_+)|(_+$)/g,"")}function s(e){var t=i(e);return _.assert(e===t,'Label key can only contain: [a-z0-9_], and no consecutive "_"s or "_" at the begining or end, got "'+e+'". This will be sent as "'+t+'"',!0),t}function r(e){return i(e)}function o(e){return e&&e.toLowerCase().replace(/(^\s+)|(\s+$)/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-+)|(-+$)/g,"")}function a(e){return e&&e.replace(/(^\s+)|(\s+$)/g,"").replace(/\|/g,"!")}function u(e){var t=e&&e.toLowerCase().replace(/[^a-z0-9\.]+/g,"_").replace(/\.+/g,".").replace(/(^_+)|(_+$)/g,"")||"no.name.page";return e!==t&&(null!==e&&"string"==typeof e&&0!==e.replace(/ */,"").length||d.error("Countername must be a non-empty string"),e&&e.search(/-/)!==-1?d.warn('Submitted countername ("'+e+'") contains at least one "-". Dashes are not permitted but, for legacy reasons, "-" and "_" are equivalent in DAx. Echo converts dashes to underscores, so the countername will be sent as "'+t+'"'):d.warn('countername may only contain: [a-z0-9._], got "'+e+'". This will be cleaned up and sent as "'+t+'"')),t.search(/\.page$/)===-1&&(t+=".page"),t}function c(e,n){var i="",s=n,c=t(e);if(c===h.COUNTERNAME&&(n=u(n)),"number"==typeof n||"boolean"==typeof n)return n.toString();if("string"!=typeof n)return void d.error("Label must have number, boolean or string value");switch(c){case h.EVENT_MASTER_BRAND:i='Label value can only contain [0-9a-z], and no consecutive "_"s and no "_"s or whitespace at the start or end.',s=r(n);break;case h.STRICT:i='Strict Label values can only contain [ 0-9a-z-], and no consecutive "-"s and no "-"s or whitespace at the start or end.',s=o(n);break;case h.NO_CLEANSING:break;default:i="Custom Label value cannot contain whitespace at start or end or pipes (|).",s=a(n)}return i+='Got "'+n+'", will be replaced with "'+s+'"',_.assert(n===s,i,!0),s}function l(e){if("number"==typeof e||"boolean"==typeof e)return e.toString();var t=e&&e.replace(/(^\s*)|(\s*$)/g,"").replace(/[^0-9a-zA-Z._]+/g,"-").replace(/(^-)|(-$)/g,"")||"";return _.assert(e===t,'Language label value can only contain [0-9a-zA-Z._-], and no consecutive "-"s and no - at the start or end. Got "'+e+'", will be replaced with "'+t+'"',!0),t}function p(e){var t,n={};for(var i in e)t=s(i),n[t]=c(t,e[i]);return n}var _=n(1),d=n(2),f=n(0),h=n(27),E=["player_name","ns_st_ws","bbc_site","app_type","app_name","bbc_store_pf","bbc_store_ed","bbc_store_fr","bbc_store_src"],g={name:h.COUNTERNAME};g[f.ManagedLabels.EVENT_MASTER_BRAND]=h.EVENT_MASTER_BRAND;for(var v=0;v<E.length;v++)g[E[v]]=h.STRICT;return{cleanCounterName:u,cleanLabelKey:s,cleanLabelValue:c,cleanLanguage:l,cleanLabels:p}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){!(e.exports={NAME:"echo_js",VERSION:"9.0.0"})},function(e,t,n){var i;i=function(e){"use strict";var t=n(1),i=function(e){this.idType=e,this.validValueRegex=/^[a-z0-9A-Z_-]+$/,this.value=null,this.isSet=!1,this.isValid=!1};return i.prototype.getIdType=function(){return this.idType},i.prototype.setValue=function(e){this.isSet=!0,this.isValid=this._validateValue(e),t.assert(this.isValid,"MediaId: The value for "+this.idType+"Id is invalid",!0),this.value=e},i.prototype.getValue=function(){return this.value},i.prototype.isValueSet=function(){return this.isSet},i.prototype.isValueValid=function(){return this.isValid},i.prototype._validateValue=function(e){return"string"==typeof e&&this.validValueRegex.test(e)},i}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(e){"use strict";function t(e){return e===r.AvType.AUDIO||e===r.AvType.VIDEO}function i(e){return e===l.ON_DEMAND||e===l.DOWNLOAD||e===l.LIVE}var s=n(8),r=n(0),o=n(1),a=n(4),u=n(6),c=n(2),l=r.MediaConsumptionMode,p=function(e,n){this.avType=t(e)?e:null,this.consumptionMode=i(n)?n:null,o.assert(this.avType,"Media: Invalid avType: "+this.avType,!0),o.assert(this.consumptionMode,"Media: Invalid consumptionMode: "+this.consumptionMode,!0),this.serviceIdObject=new s(r.MediaIdType.SERVICE),this.versionIdObject=new s(r.MediaIdType.VERSION),this.clipIdObject=new s(r.MediaIdType.CLIP),this.episodeIdObject=new s(r.MediaIdType.EPISODE),this.vpIdObject=new s(r.MediaIdType.VPID),this.length=0,this.bufferLength=0,this.supplier=null,this.mediaSet=null,this.transferFormat=null,this.scheduleMode=null,this.bitrate=0,this.codec=null,this.cdn=null,this.essEnrichedData=!1};return p.prototype.isEssEnriched=function(){return this.essEnrichedData===!0},p.prototype.setEssEnriched=function(e){this.essEnrichedData=e},p.prototype.getAvType=function(){return this.avType},p.prototype.getMediaConsumptionMode=function(){return this.consumptionMode},p.prototype.getClone=function(){var e=new p(this.avType,this.consumptionMode);return e.serviceIdObject=this.serviceIdObject,e.versionIdObject=this.versionIdObject,e.clipIdObject=this.clipIdObject,e.episodeIdObject=this.episodeIdObject,e.vpIdObject=this.vpIdObject,e.bufferLength=this.bufferLength,e.mediaSet=this.mediaSet,e.supplier=this.supplier,e.transferFormat=this.transferFormat,e.length=this.length,e.scheduleMode=this.scheduleMode,e.bitrate=this.bitrate,e.codec=this.codec,e.cdn=this.cdn,e.essEnrichedData=this.essEnrichedData,e},p.prototype.setVersionId=function(e){return this.versionIdObject.setValue(e),this},p.prototype.setClipId=function(e){return this.clipIdObject.setValue(e),this},p.prototype.setServiceId=function(e){return this.serviceIdObject.setValue(e),this},p.prototype.setEpisodeId=function(e){return this.episodeIdObject.setValue(e),this},p.prototype.setVpId=function(e){return this.vpIdObject.setValue(e),this},p.prototype.setSupplier=function(e){if(null!==e){var t=o.trim(e);0!==t.length&&(this.supplier=t)}return this},p.prototype.getSupplier=function(){return this.supplier},p.prototype.setMediaSet=function(e){if(null!=e){var t=o.trim(e);0!==t.length&&(this.mediaSet=t)}return this},p.prototype.getMediaSet=function(){return this.mediaSet},p.prototype.setMediaSelectorProperties=function(e,t,n){this.setMediaSet(e),this.setSupplier(t),this.setTransferFormat(n)},p.prototype.setTransferFormat=function(e){if(null!=e){var t=o.trim(e);0!==t.length&&(this.transferFormat=t)}return this},p.prototype.getTransferFormat=function(){return this.transferFormat},p.prototype.setLength=function(e){return void 0!==e&&null!==e&&(e=Math.floor(e)),(void 0===e||isNaN(e)||!isFinite(e)||e<0)&&(c.warn("Media: length must be an integer of 0 or greater. Echo will report as 0."),e=0),this.length=e,this},p.prototype.setBitrate=function(e){return e&&e>0?this.bitrate=e:c.warn("Invalid media bitrate: "+e),this},p.prototype.setCodec=function(e){return this.codec=u.cleanLabelValue(a.MEDIA_CODEC,e),this},p.prototype.setCDN=function(e){return this.cdn=u.cleanLabelValue(a.MEDIA_CDN,e),this},p.prototype.setScheduleMode=function(e){return e===r.EchoScheduleMode.ON||e===r.EchoScheduleMode.OFF?this.scheduleMode=e:(this.scheduleMode=null,c.warn("Media: Invalid scheduleMode: "+this.scheduleMode)),this},p.prototype.getVersionIdObject=function(){return this.versionIdObject},p.prototype.getClipIdObject=function(){return this.clipIdObject},p.prototype.getServiceIdObject=function(){return this.serviceIdObject},p.prototype.getEpisodeIdObject=function(){return this.episodeIdObject},p.prototype.getVpIdObject=function(){return this.vpIdObject},p.prototype.getVersionId=function(){return this.versionIdObject.getValue()},p.prototype.getClipId=function(){return this.clipIdObject.getValue()},p.prototype.getServiceId=function(){return this.serviceIdObject.getValue()},p.prototype.getEpisodeId=function(){return this.episodeIdObject.getValue()},p.prototype.getVpId=function(){return this.vpIdObject.getValue()},p.prototype.getLength=function(){return this.length},p.prototype.getScheduleMode=function(){return this.scheduleMode},p.prototype.getBitrate=function(){return this.bitrate},p.prototype.getCDN=function(){return this.cdn},p.prototype.getCodec=function(){return this.codec},p.prototype.getRetrievalType=function(){if(null===this.consumptionMode)return null;var e=this.consumptionMode===l.DOWNLOAD?r.RetrievalType.DOWNLOAD:r.RetrievalType.STREAM;return e},p.prototype.isOnDemand=function(){return this.consumptionMode===l.ON_DEMAND},p.prototype.isDownload=function(){return this.consumptionMode===l.DOWNLOAD},p.prototype.isLive=function(){return this.consumptionMode===l.LIVE},p.prototype.isVideo=function(){return this.avType===r.AvType.VIDEO},p}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){"use strict";function e(){this.reset()}return e.prototype.start=function(){this._isPlaying!==!0&&(this._isPlaying=!0,this._startTime=this._getCurrentTime())},e.prototype.reset=function(){this._isPlaying=!1,this._position=0,this._startTime=0},e.prototype.stop=function(){this._isPlaying&&(this._isPlaying=!1,this._position+=this._getCurrentTime()-this._startTime,this._startTime=0)},e.prototype.getPosition=function(){var e=this._position;return this._isPlaying===!0&&(e+=this._getCurrentTime()-this._startTime),e},e.prototype._getCurrentTime=function(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Date.now()},e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,s;i=[n(1),n(2),n(0)],s=function(e,t,n){"use strict";function i(e,t,n){this._schedule=[],this.serviceId=null,this._media=e,this._environment=t,this._echoClient=n,this._fetchData()}return i.prototype.getBroadcast=function(e){var t,n;for(t=0;t<this._schedule.length;t++)if(n=this._schedule[t].published_time,e<n.end&&e>=n.start)return this._schedule[t]},i.essHost="ess.api.bbci.co.uk",i.prototype._fetchData=function(){var e,n,s=this;e=this._environment.getExecuteCrossDomainGet(),n=this._environment.getProtocol(),"ms-appx:"===n&&(n="https:");var r=n+i.essHost.replace(/^(\/+)?/,"//")+"/schedules";if(this._media){if(this._media.getServiceId())r+="?serviceId="+encodeURIComponent(this._media.getServiceId());else if(this._media.getVersionId())r+="?versionId="+encodeURIComponent(this._media.getVersionId());else{if(!this._media.getVpId())return void t.info("Unable to determine serviceId, versionId or VpId for schedule");r+="?vpid="+encodeURIComponent(this._media.getVpId())}e(r,{onSuccess:function(e){s._dataSuccessHandler(e)},onError:function(e,t){var n="error";"json"===e?n="json":"object"==typeof e&&"timeout"===e.type&&(n="timeout"),s._dataErrorHandler(n,t)}})}},i.prototype.hasData=function(){return this._schedule.length>0},i.prototype._dataSuccessHandler=function(e){var n,i,s,r,o=[];if(t.info("Cross-domain schedule request success."),e){for(this._echoClient.setEssSuccess(!0),this.serviceId=e.service.id,e.items=e.items||[],n=0;n<e.items.length;n++)s=e.items[n].published_time.start,r=e.items[n].published_time.end,i=e.items[n],i.published_time.start=new Date(s).getTime(),i.published_time.end=new Date(r).getTime(),o.push(i);this._schedule=o}},i.prototype._dataErrorHandler=function(e,i){this._schedule=[],t.error("There was a problem requesting the schedule from ESS: "+e),this._echoClient.setEssSuccess(!1),"json"===e?this._echoClient.setEssError(n.EssError.JSON,i):"timeout"===e?this._echoClient.setEssError(n.EssError.TIMEOUT,i):"error"===e&&void 0!==i?this._echoClient.setEssError(n.EssError.STATUS_CODE,i):this._echoClient.setEssError(n.EssError.RUNTIME,"0")},i}.apply(t,i),!(void 0!==s&&(e.exports=s))},function(e,t,n){var i;i=function(){"use strict";var e={getCookieValueByName:function(e,t){var n=t||window,i=e+"=",s=n.document,r={};if("undefined"==typeof s||"string"!=typeof s.cookie)return null;r=s.cookie.split(";");for(var o=0,a=r.length;o<a;o++){var u=r[o];if(" "===u.charAt(0)&&(u=u.substring(1,u.length)),0===u.indexOf(i))return u.substring(i.length,u.length)}return null}};return e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,s;i=[n(17)],s=function(e){"use strict";return window&&window.bbccookies&&e.Environment.setOrbCookies(window.bbccookies),e}.apply(t,i),!(void 0!==s&&(e.exports=s))},function(e,t,n){var i;i=function(){var e=e||{};return e.PlatformAPIs=e.PlatformAPIs||{Standard:0,Trilithium:1,AppleTV:2,Chromecast:3},e.Utils=e.Utils||function(){return{uid:function(){var e=1;return function(){return+new Date+"_"+e++}}(),filter:function(e,t){var n={};for(var i in t)t.hasOwnProperty(i)&&e(t[i])&&(n[i]=t[i]);return n},extend:function(e){var t,n=arguments.length;e=e||{};for(var i=1;i<n;i++)if(t=arguments[i])for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);return e},getString:function(e,t){var n=String(e);return null==e?t||"na":n},getLong:function(e,t){var n=Number(e);return null==e||isNaN(n)?t||0:n},getInteger:function(e,t){var n=Number(e);return null==e||isNaN(n)?t||0:n},getBoolean:function(e,t){var n="true"==String(e).toLowerCase();return null==e?t||!1:n},isNotEmpty:function(e){return"undefined"!=typeof e&&null!=e&&"undefined"!=typeof e.length&&e.length>0},indexOf:function(e,t){var n=-1;return this.forEach(t,function(t,i){t==e&&(n=i)}),n},forEach:function(e,t,n){try{if("function"==typeof t)if(n="undefined"!=typeof n?n:null,"number"!=typeof e.length||"undefined"==typeof e[0]){var i="undefined"!=typeof e.__proto__;for(var s in e)e.hasOwnProperty(s)&&(!i||i&&"undefined"==typeof e.__proto__[s])&&"function"!=typeof e[s]&&t.call(n,e[s],s)}else for(var r=0,o=e.length;r<o;r++)t.call(n,e[r],r)}catch(e){}},regionMatches:function(e,t,n,i,s){if(t<0||i<0||t+s>e.length||i+s>n.length)return!1;for(;--s>=0;){var r=e.charAt(t++),o=n.charAt(i++);if(r!=o)return!1}return!0},size:function(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t},log:function(e,t){if("undefined"!=typeof t&&t&&"undefined"!=typeof console&&console){var n=new Date,i=n.getHours()+":"+n.getMinutes()+":"+n.getSeconds();console.log(i,e)}},isTrue:function(e){return"undefined"!=typeof e&&("string"==typeof e?(e=e.toLowerCase(),"true"===e||"1"===e||"on"===e):!!e)},toString:function(e){if("undefined"==typeof e)return"undefined";if("string"==typeof e)return e;if("[object Array]"===Object.prototype.toString.call(e))return e.join(",");if(this.size(e)>0){var t="";for(var n in e)e.hasOwnProperty(n)&&(t+=n+":"+e[n]+";");return t}return e.toString()},exists:function(e){return"undefined"!=typeof e&&null!=e},firstGreaterThan0:function(){for(var e=0,t=arguments.length;e<t;e++){var n=arguments[e];if(n>0)return n}return 0},cloneObject:function(e){if(null==e||"object"!=typeof e)return e;var t=function(){function e(){}function t(t){return"object"==typeof t?(e.prototype=t,new e):t}function n(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}function i(){this.copiedObjects=[];var e=this;this.recursiveDeepCopy=function(t){return e.deepCopy(t)},this.depth=0}function s(e,t){var n=new i;return t&&(n.maxDepth=t),n.deepCopy(e)}function r(e){return"undefined"!=typeof window&&window&&window.Node?e instanceof Node:e===document||"number"==typeof e.nodeType&&e.attributes&&e.childNodes&&e.cloneNode}var o=[];return n.prototype={constructor:n,canCopy:function(){return!1},create:function(e){},populate:function(e,t,n){}},i.prototype={constructor:i,maxDepth:256,cacheResult:function(e,t){this.copiedObjects.push([e,t])},getCachedResult:function(e){for(var t=this.copiedObjects,n=t.length,i=0;i<n;i++)if(t[i][0]===e)return t[i][1]},deepCopy:function(e){if(null===e)return null;if("object"!=typeof e)return e;var t=this.getCachedResult(e);if(t)return t;for(var n=0;n<o.length;n++){var i=o[n];if(i.canCopy(e))return this.applyDeepCopier(i,e)}throw new Error("Unable to clone the following object "+e)},applyDeepCopier:function(e,t){var n=e.create(t);if(this.cacheResult(t,n),this.depth++,this.depth>this.maxDepth)throw new Error("Maximum recursion depth exceeded.");return e.populate(this.recursiveDeepCopy,t,n),this.depth--,n}},s.DeepCopier=n,s.deepCopiers=o,s.register=function(e){e instanceof n||(e=new n(e)),o.unshift(e)},s.register({canCopy:function(){return!0},create:function(e){return e instanceof e.constructor?t(e.constructor.prototype):{}},populate:function(e,t,n){for(var i in t)t.hasOwnProperty(i)&&(n[i]=e(t[i]));return n}}),s.register({canCopy:function(e){return e instanceof Array},create:function(e){return new e.constructor},populate:function(e,t,n){for(var i=0;i<t.length;i++)n.push(e(t[i]));return n}}),s.register({canCopy:function(e){return e instanceof Date},create:function(e){return new Date(e)}}),s.register({canCopy:function(e){return r(e)},create:function(e){return e===document?document:e.cloneNode(!1)},populate:function(e,t,n){if(t===document)return document;if(t.childNodes&&t.childNodes.length)for(var i=0;i<t.childNodes.length;i++){var s=e(t.childNodes[i]);n.appendChild(s)}}}),{deepCopy:s}}();return t.deepCopy(e)},safeGet:function(e,t){return t=this.exists(t)?t:"",this.exists(e)?e:t},getBrowserName:function(){if("undefined"==typeof navigator||!navigator.hasOwnProperty("userAgent")||!navigator.hasOwnProperty("appName"))return"";var e,t,n=navigator.userAgent,i=navigator.appName;return(t=n.indexOf("Opera"))!=-1||(t=n.indexOf("OPR/"))!=-1?i="Opera":(t=n.indexOf("Android"))!=-1?i="Android":(t=n.indexOf("Chrome"))!=-1?i="Chrome":(t=n.indexOf("Safari"))!=-1?i="Safari":(t=n.indexOf("Firefox"))!=-1?i="Firefox":(t=n.indexOf("IEMobile"))!=-1?i="Internet Explorer Mobile":"Microsoft Internet Explorer"==i||"Netscape"==i?i="Internet Explorer":(e=n.lastIndexOf(" ")+1)<(t=n.lastIndexOf("/"))&&(i=n.substring(e,t),i.toLowerCase()==i.toUpperCase()&&(i=navigator.appName)),i},getBrowserFullVersion:function(){if("undefined"==typeof navigator||!navigator.hasOwnProperty("userAgent")||!navigator.hasOwnProperty("appName")||!navigator.hasOwnProperty("appVersion"))return"";var e,t,n,i,s=navigator.userAgent,r=navigator.appName,o=""+parseFloat(navigator.appVersion);return(t=s.indexOf("Opera"))!=-1?(o=s.substring(t+6),(t=s.indexOf("Version"))!=-1&&(o=s.substring(t+8))):(t=s.indexOf("OPR/"))!=-1?o=s.substring(t+4):(t=s.indexOf("Android"))!=-1?o=s.substring(t+11):(t=s.indexOf("Chrome"))!=-1?o=s.substring(t+7):(t=s.indexOf("Safari"))!=-1?(o=s.substring(t+7),(t=s.indexOf("Version"))!=-1&&(o=s.substring(t+8))):(t=s.indexOf("Firefox"))!=-1?o=s.substring(t+8):"Microsoft Internet Explorer"==r?(i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=i.exec(s)&&(o=parseFloat(RegExp.$1))):"Netscape"==r?(i=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!=i.exec(s)&&(o=parseFloat(RegExp.$1))):s.lastIndexOf(" ")+1<(t=s.lastIndexOf("/"))&&(o=s.substring(t+1)),o=o.toString(),(n=o.indexOf(";"))!=-1&&(o=o.substring(0,n)),(n=o.indexOf(" "))!=-1&&(o=o.substring(0,n)),(n=o.indexOf(")"))!=-1&&(o=o.substring(0,n)),e=parseInt(""+o,10),isNaN(e)&&(o=""+parseFloat(navigator.appVersion)),o},browserAcceptsLargeURLs:function(){return"undefined"==typeof window||(null===window.ActiveXObject||!0)}}}(),e.StreamSense=e.StreamSense||function(){function t(e,t){var n=e||"",s="undefined",r=v.comScore||v.sitestat||function(e){var t,n,r,o,a,u="comScore=",c=m.cookie,l="",p="indexOf",_="substring",d="length",h=i.browserAcceptsLargeURLs()?I.URL_LENGTH_LIMIT:I.RESTRICTED_URL_LENGTH_LIMIT,E="&ns_",g="&",y=v.encodeURIComponent||escape;if(c[p](u)+1)for(o=0,r=c.split(";"),a=r[d];o<a;o++)n=r[o][p](u),n+1&&(l=g+unescape(r[o][_](n+u[d])));e+=E+"_t="+ +new Date+E+"c="+(m.characterSet||m.defaultCharset||"")+l,e.length>h&&e.indexOf(g)>0&&(t=e.substr(0,h-8).lastIndexOf(g),e=(e.substring(0,t)+E+"cut="+y(e.substring(t+1))).substr(0,h)),f.httpGet(e),typeof ns_p===s&&(ns_p={src:e}),ns_p.lastMeasurement=e};if(typeof t!==s){var o=[],a=v.encodeURIComponent||escape;for(var u in t)t.hasOwnProperty(u)&&o.push(a(u)+"="+a(t[u]));/[\?\&]$/.test(n)||(n+="&"),n+=o.join("&")}return r(n)}function n(e,t){for(var n,s=v.encodeURIComponent||escape,r=[],o=I.LABELS_ORDER,a=e.split("?"),u=a[0],c=a[1],l=c.split("&"),p=0,_=l.length;p<_;p++){var d=l[p].split("="),f=unescape(d[0]),h=unescape(d[1]);f&&(t[f]=h)}for(var E={},g=0,y=o.length;g<y;g++){var S=o[g];if(t.hasOwnProperty(S)){var C=t[S];"undefined"!=typeof C&&null!=C&&(E[S]=!0,r.push(s(S)+"="+s(t[S])))}}for(var b in t)if(t.hasOwnProperty(b)){if(E[b])continue;var L=t[b];"undefined"!=typeof L&&null!=L&&r.push(s(b)+"="+s(t[b]))}n=u+"?"+r.join("&"),n=n+(n.indexOf("&c8=")<0?"&c8="+s(m.title):"")+(n.indexOf("&c7=")<0?"&c7="+s(m.URL):"")+(n.indexOf("&c9=")<0?"&c9="+s(m.referrer):"");var P=i.browserAcceptsLargeURLs()?I.URL_LENGTH_LIMIT:I.RESTRICTED_URL_LENGTH_LIMIT;if(n.length>P&&n.indexOf("&")>0){var A=n.substr(0,P-8).lastIndexOf("&");n=(n.substring(0,A)+"&ns_cut="+s(n.substring(A+1))).substr(0,P)}return n}var i=e.Utils,s=function(){var e="cs_";return function(){var t="undefined"!=typeof localStorage?localStorage:{};i.extend(this,{get:function(n){return t[e+n]},set:function(n,i){t[e+n]=i},has:function(n){return e+n in t},remove:function(n){delete t[e+n]},clear:function(){for(var e in t)t.hasOwnProperty(e)&&delete t[e]}})}}(),r=function(){var e="cs_",t=function(){var t="undefined"!=typeof atv&&"undefined"!=typeof atv.localStorage&&atv.localStorage||null;i.extend(this,{get:function(n){return t&&n&&t.getItem(e+n)||null},set:function(n,i){t&&n&&(t[e+n]=i)},has:function(n){
return t&&n&&null!=t.getItem(e+n)||!1},remove:function(n){t&&n&&t.removeItem(e+n)},clear:function(){}})};return t}(),o=function(e,t){if("undefined"!=typeof Image){var n=new Image;n.onload=function(){t&&t(200),n=null},n.onerror=function(){t&&t(),n=null},n.src=e}},a=function(e,t,n){"undefined"!=typeof XMLHttpRequest&&n&&"undefined"!=typeof setTimeout&&setTimeout(n,0);var i=new XMLHttpRequest;i.open("POST",e,!0),i.onreadystatechange=function(){4===i.readyState&&(n&&n(i.status),i=null)},i.send(t)},u=function(e,t,n){n&&"undefined"!=typeof setTimeout&&setTimeout(n,0)},c=function(){function e(e){var t=u+e;p[t]="",_[t]=[]}function t(e,t){var n=u+e;p[n]+=d+o(t),_[n].push(t)}function n(e,t){var n=u+e,s=_[n];s.splice(i.indexOf(t,s),1);for(var r=[],a=0,c=s.length;a<c;a++)r.push(o(s[a]));p[n]=r.join(d),delete p[l+e+t]}function s(e,t,n){p[l+e+t]=n}function r(e,t){return p[l+e+t]}var o="undefined"!=typeof encodeURIComponent?encodeURIComponent:escape,a="undefined"!=typeof decodeURIComponent?decodeURIComponent:unescape,u="cs_dir_",l="cs_file_",p="undefined"!=typeof localStorage?localStorage:{},_={},d="|";return{dir:function(e){var t=u+e,n=_[t];if(n)return n.slice();var i=p[t];if(i){i=i.split(d),n=[];for(var s=0,r=i.length;s<r;s++)i[s].length>0&&n.push(a(i[s]));return _[t]=n,n.slice()}return null},append:function(e,t,n){var i=c.read(e,t);i?i+=n:i=n,c.write(e,t,i)},write:function(n,r,o){var a=c.dir(n);a||(e(n),a=[]),i.indexOf(r,a)==-1&&t(n,r),s(n,r,o)},deleteFile:function(e,t){var s=c.dir(e);return!!s&&(i.indexOf(t,s)!=-1&&(n(e,t),!0))},read:function(e,t){var n=c.dir(e);return n?i.indexOf(t,n)==-1?null:r(e,t):null}}}(),l=function(){return{dir:function(){return null},append:function(e,t,n){},write:function(e,t,n){},deleteFile:function(){return!1},read:function(){return null}}}(),p=function(e,t){"undefined"!=typeof engine&&t&&"undefined"!=typeof setTimeout&&setTimeout(t,0);var n=engine.createHttpClient(),i=n.createRequest("GET",e,null);i.start(),t&&setTimeout(t,0)},_=function(e,t){if("undefined"!=typeof atv&&"function"==typeof atv.setTimeout){"undefined"!=typeof XMLHttpRequest&&t&&atv.setTimeout(t,0);var n=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(){4===n.readyState&&(t&&t(n.status),n=null)},n.send()}},d=function(e,t,n){if("undefined"!=typeof atv&&"function"==typeof atv.setTimeout){"undefined"!=typeof XMLHttpRequest&&n&&atv.setTimeout(n,0);var i=new XMLHttpRequest;i.open("POST",e,!0),i.onreadystatechange=function(){4===i.readyState&&(n&&n(i.status),i=null)},i.send(t)}},f=function(){return{PLATFORM:"generic",httpGet:o,httpPost:u,Storage:s,IO:l,getCrossPublisherId:function(){return null},getAppName:function(){return Constants.UNKNOWN_VALUE},getAppVersion:function(){return Constants.UNKNOWN_VALUE},getVisitorId:function(){return this.getDeviceName()+ +new Date+~~(1e3*Math.random())},getVisitorIdSuffix:function(){return"72"},getDeviceName:function(){return""},getPlatformVersion:function(){return""},getPlatformName:function(){return"js"},getRuntimeName:function(){return""},getRuntimeVersion:function(){return""},getResolution:function(){return""},getLanguage:function(){return""},getPackageName:function(){return""},isConnectionAvailable:function(){return!0},isCompatible:function(){return!0},autoSelect:function(){},setPlatformAPI:function(){},isCrossPublisherIdChanged:function(){return!1},setTimeout:function(e,t,n){return setTimeout(e,t,n)},clearTimeout:function(e){return clearTimeout(e)},getDeviceArchitecture:function(){return Constants.UNKNOWN_VALUE},getConnectionType:function(){return Constants.UNKNOWN_VALUE},getDeviceJailBrokenFlag:function(){return Constants.UNKNOWN_VALUE}}}(),h=function(){function e(){return"undefined"!=typeof engine&&"undefined"!=typeof engine.stats}function t(){return i.isNotEmpty(engine.stats.device.id)?engine.stats.device.id:i.isNotEmpty(engine.stats.network.mac)?engine.stats.network.mac:null}function n(){if(null==r){var e=t();null!=e?(r=e,o="31",a=e):(r=+new Date+~~(1e3*Math.random()),o="72",a=null)}}var r=null,o=null,a=null;return{PLATFORM:"trilithium",httpGet:p,httpPost:u,Storage:s,IO:l,getCrossPublisherId:function(){return n(),a},getAppName:function(){return i.isNotEmpty(engine.stats.application.name)?engine.stats.application.name:Constants.UNKNOWN_VALUE},getAppVersion:function(){return i.isNotEmpty(engine.stats.application.version)?engine.stats.application.version:Constants.UNKNOWN_VALUE},getVisitorId:function(){return n(),r},getVisitorIdSuffix:function(){return o},getDeviceName:function(){return i.safeGet(engine.stats.device.platform,"")},getPlatformVersion:function(){return i.safeGet(engine.stats.device.version,"")},getPlatformName:function(){return"js"},getRuntimeName:function(){return"trilithium"},getRuntimeVersion:function(){return""},getResolution:function(){return"undefined"!=typeof screen&&"undefined"!=typeof screen.height&&"undefined"!=typeof screen.width?screen.height+"x"+screen.width:""},getLanguage:function(){return""},getPackageName:function(){return""},isConnectionAvailable:function(){return!0},isCompatible:e}}(),E=function(){function e(){return"undefined"==typeof window&&"undefined"!=typeof atv}function t(){null==n&&("undefined"!=typeof atv&&"undefined"!=typeof atv.device&&atv.device.idForVendor?(n=i.safeGet(atv.device.idForVendor,""),s="62"):(n=+new Date+~~(1e3*Math.random()),s="72"),o=null)}var n=null,s=null,o=null;return{PLATFORM:"atv",httpGet:_,httpPost:d,Storage:r,IO:l,getCrossPublisherId:function(){return t(),o},getAppName:function(){return Constants.UNKNOWN_VALUE},getAppVersion:function(){return Constants.UNKNOWN_VALUE},getVisitorId:function(){return t(),n},getVisitorIdSuffix:function(){return s},getDeviceName:function(){return"Apple TV"},getPlatformVersion:function(){return"undefined"!=typeof atv&&"undefined"!=typeof atv.device&&i.safeGet(atv.device.softwareVersion,"")},getPlatformName:function(){return"js"},getRuntimeName:function(){return"atv"},getRuntimeVersion:function(){return"undefined"!=typeof atv&&"undefined"!=typeof atv.device&&i.safeGet(atv.device.softwareVersion,"")},getResolution:function(){return"undefined"!=typeof atv.device&&"undefined"!=typeof atv.device.screenFrame&&"undefined"!=typeof atv.device.screenFrame.height&&"undefined"!=typeof atv.device.screenFrame.width?atv.device.screenFrame.height+"x"+atv.device.screenFrame.width:""},getLanguage:function(){return"undefined"!=typeof atv&&"undefined"!=typeof atv.device&&i.safeGet(atv.device.language,"")},getPackageName:function(){return""},isConnectionAvailable:function(){return!0},setTimeout:function(e,t,n){return"undefined"!=typeof atv&&"undefined"!=typeof atv.setTimeout&&atv.setTimeout(e,t,n)},clearTimeout:function(e){return"undefined"!=typeof atv&&"undefined"!=typeof atv.clearTimeout&&atv.clearTimeout(e)},isCompatible:e}}(),g=function(){function e(){return"undefined"!=typeof window&&"undefined"!=typeof document}return{PLATFORM:"chromecast",httpGet:o,httpPost:a,Storage:s,IO:c,getCrossPublisherId:function(){return null},getAppName:function(){return"undefined"!=typeof document&&document.title||Constants.UNKNOWN_VALUE},getAppVersion:function(){return Constants.UNKNOWN_VALUE},getVisitorId:function(){return+new Date+~~(1e3*Math.random())},getVisitorIdSuffix:function(){return"72"},getDeviceName:function(){return"chromecast"},getPlatformVersion:function(){return"5"},getPlatformName:function(){return"js"},getRuntimeName:function(){return"html"},getRuntimeVersion:function(){return i.safeGet(i.getBrowserName()+" "+i.getBrowserFullVersion(),Constants.UNKNOWN_VALUE)},getResolution:function(){var e="undefined"!=typeof window&&i.exists(window.screen)&&i.exists(window.screen.availWidth)?window.screen.availWidth:0,t="undefined"!=typeof window&&i.exists(window.screen)&&i.exists(window.screen.availHeight)?window.screen.availHeight:0;return e>0&&t>0?e+"x"+t:""},getLanguage:function(){return"undefined"!=typeof window&&i.exists(window.navigator)&&i.safeGet(window.navigator.language,"")||""},getPackageName:function(){return"undefined"!=typeof castReceiverManager&&castReceiverManager.getApplicationData&&"function"==typeof castReceiverManager.getApplicationData&&castReceiverManager.getApplicationData().namespaces&&castReceiverManager.getApplicationData().namespaces[0]||""},isConnectionAvailable:function(){return"undefined"!=typeof window&&i.exists(window.navigator)&&i.safeGet(window.navigator.onLine,!0)||!0},isCompatible:e,getConnectionType:function(){return Constants.UNKNOWN_VALUE}}}();f.autoSelect=function(){h.isCompatible()?e.Utils.extend(f,h):E.isCompatible()&&e.Utils.extend(f,E)},f.setPlatformAPI=function(t){var n=!1;switch(t){case e.PlatformAPIs.Trilithium:e.Utils.extend(f,h),n=!0;break;case e.PlatformAPIs.AppleTV:e.Utils.extend(f,E),n=!0;break;case e.PlatformAPIs.Chromecast:i.extend(f,g),n=!0}n&&(f.autoSelect=function(){})};var v,m,y="undefined"!=typeof window&&"undefined"!=typeof document;y?(v=window,m=document):(v={},m={location:{href:""},title:"",URL:"",referrer:"",cookie:""});var i=i||{};i.filterMap=function(e,t){for(var n in e)e.hasOwnProperty(n)&&i.indexOf(n,t)==-1&&delete e[n]},i.getKeys=function(e,t){var n,i=[];for(n in e)(!t||t.test(n))&&e.hasOwnProperty(n)&&(i[i.length]=n);return i};var S=function(){var e=["play","pause","end","buffer","keep-alive","hb","custom","ad_play","ad_pause","ad_end","ad_click"];return{PLAY:0,PAUSE:1,END:2,BUFFER:3,KEEP_ALIVE:4,HEART_BEAT:5,CUSTOM:6,AD_PLAY:7,AD_PAUSE:8,AD_END:9,AD_CLICK:10,toString:function(t){return e[t]}}}(),C=function(){var e=[S.END,S.PLAY,S.PAUSE,S.BUFFER];return{IDLE:0,PLAYING:1,PAUSED:2,BUFFERING:3,toEventType:function(t){return e[t]}}}(),b={ADPLAY:S.AD_PLAY,ADPAUSE:S.AD_PAUSE,ADEND:S.AD_END,ADCLICK:S.AD_CLICK},I={STREAMSENSE_VERSION:"4.1505.18",DEFAULT_PLAYERNAME:"streamsense",DEFAULT_HEARTBEAT_INTERVAL:[{playingtime:6e4,interval:1e4},{playingtime:null,interval:6e4}],DEFAULT_KEEP_ALIVE_INTERVAL:12e5,DEFAULT_PAUSED_ON_BUFFERING_INTERVAL:500,C1_VALUE:"19",C10_VALUE:"js",NS_AP_C12M_VALUE:"1",NS_NC_VALUE:"1",PAGE_NAME_LABEL:"name",RESTRICTED_URL_LENGTH_LIMIT:2048,URL_LENGTH_LIMIT:4096,LABELS_ORDER:["c1","c2","ca2","cb2","cc2","cd2","ns_site","ca_ns_site","cb_ns_site","cc_ns_site","cd_ns_site","ns_vsite","ca_ns_vsite","cb_ns_vsite","cc_ns_vsite","cd_ns_vsite","ns_ap_an","ca_ns_ap_an","cb_ns_ap_an","cc_ns_ap_an","cd_ns_ap_an","ns_ap_pn","ns_ap_pv","c12","ca12","cb12","cc12","cd12","ns_ak","ns_ap_hw","name","ns_ap_ni","ns_ap_ec","ns_ap_ev","ns_ap_device","ns_ap_id","ns_ap_csf","ns_ap_bi","ns_ap_pfm","ns_ap_pfv","ns_ap_ver","ca_ns_ap_ver","cb_ns_ap_ver","cc_ns_ap_ver","cd_ns_ap_ver","ns_ap_sv","ns_ap_cv","ns_type","ca_ns_type","cb_ns_type","cc_ns_type","cd_ns_type","ns_radio","ns_nc","ns_ap_ui","ca_ns_ap_ui","cb_ns_ap_ui","cc_ns_ap_ui","cd_ns_ap_ui","ns_ap_gs","ns_st_sv","ns_st_pv","ns_st_it","ns_st_id","ns_st_ec","ns_st_sp","ns_st_sq","ns_st_cn","ns_st_ev","ns_st_po","ns_st_cl","ns_st_el","ns_st_pb","ns_st_hc","ns_st_mp","ca_ns_st_mp","cb_ns_st_mp","cc_ns_st_mp","cd_ns_st_mp","ns_st_mv","ca_ns_st_mv","cb_ns_st_mv","cc_ns_st_mv","cd_ns_st_mv","ns_st_pn","ns_st_tp","ns_st_pt","ns_st_pa","ns_st_ad","ns_st_li","ns_st_ci","ns_ap_jb","ns_ap_res","ns_ap_sd","ns_ap_po","ns_ap_ot","ns_ap_c12m","cs_c12u","ns_ap_install","ns_ap_updated","ns_ap_lastrun","ns_ap_cs","ns_ap_runs","ns_ap_usage","ns_ap_fg","ns_ap_ft","ns_ap_dft","ns_ap_bt","ns_ap_dbt","ns_ap_dit","ns_ap_as","ns_ap_das","ns_ap_it","ns_ap_uc","ns_ap_aus","ns_ap_daus","ns_ap_us","ns_ap_dus","ns_ap_ut","ns_ap_oc","ns_ap_uxc","ns_ap_uxs","ns_ap_lang","ns_ap_ar","ns_ap_miss","ns_ts","ns_st_ca","ns_st_cp","ns_st_er","ca_ns_st_er","cb_ns_st_er","cc_ns_st_er","cd_ns_st_er","ns_st_pe","ns_st_ui","ca_ns_st_ui","cb_ns_st_ui","cc_ns_st_ui","cd_ns_st_ui","ns_st_bc","ns_st_bt","ns_st_bp","ns_st_pc","ns_st_pp","ns_st_br","ns_st_ub","ns_st_vo","ns_st_ws","ns_st_pl","ns_st_pr","ns_st_ep","ns_st_ty","ns_st_ct","ns_st_cs","ns_st_ge","ns_st_st","ns_st_dt","ns_st_de","ns_st_pu","ns_st_cu","ns_st_fee","ns_ap_i1","ns_ap_i2","ns_ap_i3","ns_ap_i4","ns_ap_i5","ns_ap_i6","ns_ap_referrer","ns_clid","ns_campaign","ns_source","ns_mchannel","ns_linkname","ns_fee","gclid","utm_campaign","utm_source","utm_medium","utm_term","utm_content","c3","ca3","cb3","cc3","cd3","c4","ca4","cb4","cc4","cd4","c5","ca5","cb5","cc5","cd5","c6","ca6","cb6","cc6","cd6","c10","c11","c13","c14","c15","c16","c7","c8","c9","ns_ap_er"]},L=function(){return function(){function e(e,t){var i=t[e];null!=i&&(n[e]=i)}var t,n,s=this,r=0,o=0,a=0,u=0,c=0,l=0;i.extend(this,{reset:function(e){null!=e&&e.length>0?i.filterMap(n,e):n={},n.hasOwnProperty("ns_st_cl")||(n.ns_st_cl="0"),n.hasOwnProperty("ns_st_pn")||(n.ns_st_pn="1"),n.hasOwnProperty("ns_st_tp")||(n.ns_st_tp="1"),s.setPauses(0),s.setStarts(0),s.setBufferingTime(0),s.setBufferingTimestamp(-1),s.setPlaybackTime(0),s.setPlaybackTimestamp(-1)},setLabels:function(e,t){null!=e&&i.extend(n,e),s.setRegisters(n,t)},getLabels:function(){return n},setLabel:function(e,t){var n={};n[e]=t,s.setLabels(n,null)},getLabel:function(e){return n[e]},getClipId:function(){return("undefined"==typeof t||null==t)&&s.setClipId("1"),t},setClipId:function(e){t=e},setRegisters:function(t,n){var i=t.ns_st_cn;null!=i&&(s.setClipId(i),delete t.ns_st_cn),i=t.ns_st_bt,null!=i&&(a=Number(i),delete t.ns_st_bt),e("ns_st_cl",t),e("ns_st_pn",t),e("ns_st_tp",t),e("ns_st_ub",t),e("ns_st_br",t),n!=C.PLAYING&&null!=n||(i=t.ns_st_sq,null!=i&&(o=Number(i),delete t.ns_st_sq)),n!=C.BUFFERING&&(i=t.ns_st_pt,null!=i&&(c=Number(i),delete t.ns_st_pt)),n!=C.PAUSED&&n!=C.IDLE&&null!=n||(i=t.ns_st_pc,null!=i&&(r=Number(i),delete t.ns_st_pc))},createLabels:function(e,t){var n=t||{};return n.ns_st_cn=s.getClipId(),n.ns_st_bt=String(s.getBufferingTime()),e!=S.PLAY&&null!=e||(n.ns_st_sq=String(o)),e!=S.PAUSE&&e!=S.END&&e!=S.KEEP_ALIVE&&e!=S.HEART_BEAT&&null!=e||(n.ns_st_pt=String(s.getPlaybackTime()),n.ns_st_pc=String(r)),i.extend(n,s.getLabels()),n},incrementPauses:function(){r++},incrementStarts:function(){o++},getBufferingTime:function(){var e=a;return u>=0&&(e+=+new Date-u),e},setBufferingTime:function(e){a=e},getPlaybackTime:function(){var e=c;return l>=0&&(e+=+new Date-l),e},setPlaybackTime:function(e){c=e},getPlaybackTimestamp:function(){return l},setPlaybackTimestamp:function(e){l=e},getBufferingTimestamp:function(){return u},setBufferingTimestamp:function(e){u=e},getPauses:function(){return r},setPauses:function(e){r=e},getStarts:function(){return o},setStarts:function(e){o=e}}),n={},s.reset()}}(),P=function(){return function(){var e,t,n=this,s=null,r=0,o=0,a=0,u=0,c=0,l=0,p=!1;i.extend(this,{reset:function(e){null!=e&&e.length>0?i.filterMap(t,e):t={},n.setPlaylistId(+new Date+"_"+l),n.setBufferingTime(0),n.setPlaybackTime(0),n.setPauses(0),n.setStarts(0),n.setRebufferCount(0),p=!1},setLabels:function(e,s){null!=e&&i.extend(t,e),n.setRegisters(t,s)},getLabels:function(){return t},setLabel:function(e,t){var i={};i[e]=t,n.setLabels(i,null)},getLabel:function(e){return t[e]},getClip:function(){return s},getPlaylistId:function(){return e},setPlaylistId:function(t){e=t},setRegisters:function(t,n){var i=t.ns_st_sp;null!=i&&(r=Number(i),delete t.ns_st_sp),i=t.ns_st_bc,null!=i&&(a=Number(i),delete t.ns_st_bc),i=t.ns_st_bp,null!=i&&(u=Number(i),delete t.ns_st_bp),i=t.ns_st_id,null!=i&&(e=i,delete t.ns_st_id),n!=C.BUFFERING&&(i=t.ns_st_pa,null!=i&&(c=Number(i),delete t.ns_st_pa)),n!=C.PAUSED&&n!=C.IDLE&&null!=n||(i=t.ns_st_pp,null!=i&&(o=Number(i),delete t.ns_st_pp))},createLabels:function(t,s){var u=s||{};return u.ns_st_bp=String(n.getBufferingTime()),u.ns_st_sp=String(r),u.ns_st_id=String(e),a>0&&(u.ns_st_bc=String(a)),t!=S.PAUSE&&t!=S.END&&t!=S.KEEP_ALIVE&&t!=S.HEART_BEAT&&null!=t||(u.ns_st_pa=String(n.getPlaybackTime()),u.ns_st_pp=String(o)),t!=S.PLAY&&null!=t||n.didFirstPlayOccurred()||(u.ns_st_pb="1",n.setFirstPlayOccurred(!0)),i.extend(u,n.getLabels()),u},incrementStarts:function(){r++},incrementPauses:function(){o++,s.incrementPauses()},setPlaylistCounter:function(e){l=e},incrementPlaylistCounter:function(){l++},addPlaybackTime:function(e){if(s.getPlaybackTimestamp()>=0){var t=e-s.getPlaybackTimestamp();s.setPlaybackTimestamp(-1),s.setPlaybackTime(s.getPlaybackTime()+t),n.setPlaybackTime(n.getPlaybackTime()+t)}},addBufferingTime:function(e){if(s.getBufferingTimestamp()>=0){var t=e-s.getBufferingTimestamp();s.setBufferingTimestamp(-1),s.setBufferingTime(s.getBufferingTime()+t),n.setBufferingTime(n.getBufferingTime()+t)}},getBufferingTime:function(){var e=u;return s.getBufferingTimestamp()>=0&&(e+=+new Date-s.getBufferingTimestamp()),e},setBufferingTime:function(e){u=e},getPlaybackTime:function(){var e=c;return s.getPlaybackTimestamp()>=0&&(e+=+new Date-s.getPlaybackTimestamp()),e},setPlaybackTime:function(e){c=e},getStarts:function(){return r},setStarts:function(e){r=e},getPauses:function(){return o},setPauses:function(e){o=e},getRebufferCount:function(){return a},incrementRebufferCount:function(){a++},setRebufferCount:function(e){a=e},didFirstPlayOccurred:function(){return p},setFirstPlayOccurred:function(e){p=e}}),s=new L,t={},n.reset()}}(),A=function(){var s=function(s,r,o){function a(e){var t=0;if(null!=de)for(var n=0;n<de.length;n++){var i=de[n],s=i.playingtime;if(!s||e<s){t=i.interval;break}}return t}function u(){_();var e=a(pe.getClip().getPlaybackTime());if(e>0){var t=Ee>0?Ee:e;Q=f.setTimeout(p,t)}Ee=0}function c(){_();var e=a(pe.getClip().getPlaybackTime());Ee=e-pe.getClip().getPlaybackTime()%e,null!=Q&&_()}function l(){Ee=0,ve=0,ge=0}function p(){ge++;var e=G(S.HEART_BEAT,null);O(e),Ee=0,u()}function _(){null!=Q&&(f.clearTimeout(Q),Q=null)}function d(){E(),Z=f.setTimeout(h,fe)}function h(){var e=G(S.KEEP_ALIVE,null);O(e),le++,d()}function E(){null!=Z&&(f.clearTimeout(Z),Z=null)}function g(){m(),re.isPauseOnBufferingEnabled()&&V(C.PAUSED)&&(J=f.setTimeout(v,he))}function v(){if(ee==C.PLAYING){pe.incrementRebufferCount(),pe.incrementPauses();var e=G(S.PAUSE,null);O(e),le++,ee=C.PAUSED}}function m(){null!=J&&(f.clearTimeout(J),J=null)}function y(e){return e==C.PLAYING||e==C.PAUSED}function b(){q&&(f.clearTimeout(q),q=null)}function L(e){return e==S.PLAY?C.PLAYING:e==S.PAUSE?C.PAUSED:e==S.BUFFER?C.BUFFERING:e==S.END?C.IDLE:null}function A(e,t,n){if(b(),n)q=f.setTimeout(function(e,t){return function(){A(e,t)}}(e,t),n);else if(U(e)){var s=k(),r=ue,o=B(t),a=r>=0?o-r:0;D(k(),t),M(e,t),H(k()),x(e);for(var u=0,c=se.length;u<c;u++)se[u](s,e,t,a);T(t),pe.setRegisters(t,e),pe.getClip().setRegisters(t,e);var l=G(C.toEventType(e),t);i.extend(l,t),V(z)&&(O(l),ee=z,le++)}}function T(e){var t=e.ns_st_mp;null!=t&&(te=t,delete e.ns_st_mp),t=e.ns_st_mv,null!=t&&(ne=t,delete e.ns_st_mv),t=e.ns_st_ec,null!=t&&(le=Number(t),delete e.ns_st_ec)}function O(e,t){void 0===t&&(t=!0),t&&N(e);var i=re.getPixelURL();if(X){if(!R()){var s=ye.am,r=ye.et,o=s.newApplicationMeasurement(X,r.HIDDEN,e,i);X.getQueue().offer(o)}}else i&&f.httpGet(n(i,e))}function R(){var e=X.getAppContext(),t=X.getSalt(),n=X.getPixelURL();return null==e||null==t||0==t.length||null==n||0==n.length}function N(e){ie=G(null),i.extend(ie,e)}function D(e,t){var n=B(t);if(e==C.PLAYING)pe.addPlaybackTime(n),c(),E();else if(e==C.BUFFERING)pe.addBufferingTime(n),m();else if(e==C.IDLE){var s=i.getKeys(pe.getClip().getLabels());pe.getClip().reset(s)}}function M(e,t){var n=B(t);ce=w(t),e==C.PLAYING?(u(),d(),pe.getClip().setPlaybackTimestamp(n),V(e)&&(pe.getClip().incrementStarts(),pe.getStarts()<1&&pe.setStarts(1))):e==C.PAUSED?V(e)&&pe.incrementPauses():e==C.BUFFERING?(pe.getClip().setBufferingTimestamp(n),_e&&g()):e==C.IDLE&&l()}function V(e){return(e!=C.PAUSED&&e!=C.IDLE||ee!=C.IDLE&&null!=ee)&&(e!=C.BUFFERING&&ee!=e)}function w(e){var t=-1;return e.hasOwnProperty("ns_st_po")&&(t=i.getInteger(e.ns_st_po)),t}function B(e){var t=-1;return e.hasOwnProperty("ns_ts")&&(t=Number(e.ns_ts)),t}function U(e){return null!=e&&k()!=e}function x(e){z=e,ue=+new Date}function k(){return z}function H(e){$=e}function G(){var e,t;1==arguments.length?(e=C.toEventType(z),t=arguments[0]):(e=arguments[0],t=arguments[1]);var n={};if("undefined"!=typeof document){var s=document;n.c7=s.URL,n.c8=s.title,n.c9=s.referrer}return null!=t&&i.extend(n,t),n.hasOwnProperty("ns_ts")||(n.ns_ts=String(+new Date)),null!=e&&!n.hasOwnProperty("ns_st_ev")&&(n.ns_st_ev=S.toString(e)),i.extend(n,re.getLabels()),F(e,n),pe.createLabels(e,n),pe.getClip().createLabels(e,n),n.hasOwnProperty("ns_st_mp")||(n.ns_st_mp=te),n.hasOwnProperty("ns_st_mv")||(n.ns_st_mv=ne),n.hasOwnProperty("ns_st_ub")||(n.ns_st_ub="0"),n.hasOwnProperty("ns_st_br")||(n.ns_st_br="0"),n.hasOwnProperty("ns_st_pn")||(n.ns_st_pn="1"),n.hasOwnProperty("ns_st_tp")||(n.ns_st_tp="1"),n.hasOwnProperty("ns_st_it")||(n.ns_st_it="c"),n.ns_st_sv=I.STREAMSENSE_VERSION,n.ns_type="hidden",n}function F(e,t){var n=t||{};if(n.ns_st_ec=String(le),!n.hasOwnProperty("ns_st_po")){var s=ce,r=B(n);(e==S.PLAY||e==S.KEEP_ALIVE||e==S.HEART_BEAT||null==e&&z==C.PLAYING)&&(s+=r-pe.getClip().getPlaybackTimestamp()),n.ns_st_po=i.getInteger(s)}return e==S.HEART_BEAT&&(n.ns_st_hc=String(ge)),n}function j(e){var t=B(e);t<0&&(e.ns_ts=String(+new Date))}function Y(e,t,n){t=t||{},t.ns_st_ad=1,e>=S.AD_PLAY&&e<=S.AD_CLICK&&re.notify(e,t,n)}function W(e,t){re.notify(S.CUSTOM,e,t)}var K,q,$,z,X,J,Z,Q,ee,te,ne,ie,se,re=this,oe=500,ae=null,ue=0,ce=0,le=0,pe=null,_e=!0,de=I.DEFAULT_HEARTBEAT_INTERVAL,fe=I.DEFAULT_KEEP_ALIVE_INTERVAL,he=I.DEFAULT_PAUSED_ON_BUFFERING_INTERVAL,Ee=0,ge=0,ve=0,me=!1,ye={};o?f.setPlatformAPI(o):f.autoSelect(),i.extend(this,{reset:function(e){pe.reset(e),pe.setPlaylistCounter(0),pe.setPlaylistId(+new Date+"_1"),pe.getClip().reset(e),null==e||e.isEmpty()?K={}:i.filterMap(K,e),le=1,ge=0,c(),l(),E(),m(),b(),z=C.IDLE,$=null,ue=-1,ee=null,te=I.DEFAULT_PLAYERNAME,ne=I.STREAMSENSE_VERSION,ie=null},setPauseOnBufferingInterval:function(e){he=e},getPauseOnBufferingInterval:function(){return he},setKeepAliveInterval:function(e){fe=e},getKeepAliveInterval:function(){return fe},setHeartbeatIntervals:function(e){de=e},notify:function(){var e,t,n,s;if(t=arguments[0],3==arguments.length?(n=arguments[1],s=arguments[2]):(n={},s=arguments[1]),S.toString(t)){e=L(t);var r=i.extend({},n);if(j(r),r.hasOwnProperty("ns_st_po")||(r.ns_st_po=i.getInteger(s).toString()),t==S.PLAY||t==S.PAUSE||t==S.BUFFER||t==S.END)re.isThrottlingEnabled()&&y(z)&&y(e)&&(z!=C.PLAYING||e!=C.PAUSED||q)?A(e,r,oe):A(e,r);else{var o=G(t,r);i.extend(o,r),O(o,!1),le++}}},getLabels:function(){return K},getState:function(){return z},setLabels:function(e){for(var t in e)e.hasOwnProperty(t)&&re.setLabel(t,e[t])},getLabel:function(e){return K[e]},setLabel:function(e,t){null==t?delete K[e]:K[e]=t},setPixelURL:function(e){if(null==e||0==e.length)return null;var t=decodeURIComponent||unescape,n=e.indexOf("?");if(n>=0){if(n<e.length-1){for(var i=e.substring(n+1).split("&"),s=0,r=i.length;s<r;s++){var o=i[s],a=o.split("=");2==a.length?re.setLabel(a[0],t(a[1])):1==a.length&&re.setLabel(I.PAGE_NAME_LABEL,t(a[0]))}e=e.substring(0,n+1)}}else e+="?";return ae=e},getPixelURL:function(){return ae?ae:"undefined"!=typeof ns_p&&"string"==typeof ns_p.src?ae=ns_p.src.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):"string"==typeof ns_pixelUrl?ae=ns_pixelUrl.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):null},isPauseOnBufferingEnabled:function(){return _e},setPauseOnBufferingEnabled:function(e){_e=e},isThrottlingEnabled:function(){return me},setThrottlingEnabled:function(e){me=e},setThrottlingDelay:function(e){e&&e>0&&(oe=e)},getThrottlingDelay:function(){return oe},setClip:function(e,t){var n=!1;return z==C.IDLE&&(pe.getClip().reset(),pe.getClip().setLabels(e,null),t&&pe.incrementStarts(),n=!0),n},setPlaylist:function(e){var t=!1;return z==C.IDLE&&(pe.incrementPlaylistCounter(),pe.reset(),pe.getClip().reset(),pe.setLabels(e,null),t=!0),t},importState:function(e){reset();var t=i.extend({},e);pe.setRegisters(t,null),pe.getClip().setRegisters(t,null),T(t),le++},exportState:function(){return ie},getVersion:function(){return I.STREAMSENSE_VERSION},addListener:function(e){se.push(e)},removeListener:function(e){se.splice(i.indexOf(e,se),1)},getClip:function(){return pe.getClip()},getPlaylist:function(){return pe},setHttpGet:function(e){"function"==typeof e&&(f.httpGet=e)},setHttpPost:function(e){"function"==typeof e&&(f.httpPost=e)}}),i.extend(this,{adNotify:Y,customNotify:W,viewNotify:function(e,n){e=e||re.getPixelURL(),e&&t(e,n)}}),e.comScore&&(ye=e.comScore.exports,X=ye.c()),K={},le=1,z=C.IDLE,pe=new P,J=null,_e=!0,Q=null,ge=0,l(),Z=null,q=null,me=!1,ee=null,ce=0,se=[],re.reset(),s&&re.setLabels(s),r&&re.setPixelURL(r)};return function(t){function n(e,t){return b[L]||r(e,t)}function s(){L=-1;for(var t=0;t<=I;t++)if(b.hasOwnProperty(String(t))){L=t;break}return e.StreamSense.activeIndex=L,L}function r(t,n){return t=t||null,n=n||null,t&&"object"==typeof t&&(n=t,t=null),b[++I]=new e.StreamSense(n,t),s(),b[I]}function o(){var t=!1,n=L;if("number"==typeof arguments[0]&&isFinite(arguments[0]))n=arguments[0];else if(arguments[0]instanceof e.StreamSense)for(var i in b)if(b.hasOwnProperty(i)&&b[i]===arguments[0]){n=i;break}return b.hasOwnProperty(String(n))&&(t=b[n],delete b[n],t.reset(),s()),t}function a(e){return e=e||{},n().setPlaylist(e),n().getPlaylist()}function u(e,t,i){return e=e||{},"number"==typeof t&&(e.ns_st_cn=t),n().setClip(e,i),n().getClip()}function c(e,t,i){return"undefined"!=typeof e&&(i=i||null,t=t||{},n().notify(e,t,i))}function l(e){"undefined"!=typeof e&&n().setLabels(e)}function p(){return n().getLabels()}function _(e){"undefined"!=typeof e&&n().getPlaylist().setLabels(e)}function d(){return n().getPlaylist().getLabels()}function f(e){"undefined"!=typeof e&&n().getClip().setLabels(e)}function h(){return n().getClip().getLabels()}function E(e){return n().reset(e||{})}function g(e){return n().getPlaylist().reset(e||{})}function v(e){return n().getClip().reset(e||{})}function m(e){return e=e||{},n().viewNotify(null,e)}function y(e,t){return arguments.length>2&&(e=arguments[1],t=arguments[2]),e=e||{},"number"==typeof t&&(e.ns_st_po=t),n().customNotify(e,t)}function S(){return n().exportState()}function C(e){n().importState(e)}var b={},I=-1,L=-1;i.extend(t,{activeIndex:L,newInstance:r,new:r,destroyInstance:o,destroy:o,newPlaylist:a,newClip:u,notify:c,setLabels:l,getLabels:p,setPlaylistLabels:_,getPlaylistLabels:d,setClipLabels:f,getClipLabels:h,resetInstance:E,resetPlaylist:g,resetClip:v,viewEvent:m,customEvent:y,exportState:S,importState:C})}(s),s}();return A.AdEvents=b,A.PlayerEvents=S,A.InternalStates=C,A.getPlatformAPI=function(){return f},A}(),e.StreamingTag=e.StreamingTag||function(){var t=e.Utils,n=e.StreamSense,i=e.StreamSense.PlayerEvents,s=(e.StreamSense.AdEvents,e.StreamSense.InternalStates||null),r=null!=e.StreamSense.InternalStates;return function(){var o=function(o){function a(){if(r)if(e.comScore)S=new n,S.setLabel("ns_st_it","r");else if(t.exists(o))if(C=t.isTrue(o.debug),t.exists(o.customerC2)&&o.customerC2.length>0){var i=o.secure?"https://sb":"http"+("s"==document.location.href.charAt(4)?"s://sb":"://b");S=new n,S.setPixelURL(i+".scorecardresearch.com/p?c1=2"),S.setLabel("c2",o.customerC2),S.setLabel("ns_st_it","r")}else C&&console&&console.log("Warning: customerC2 is not provided (or incorrect) in the StreamingTag configuration.")}function u(e){return t.exists(e)||(e={}),t.exists(e.ns_st_ci)||(e.ns_st_ci="0"),t.exists(e.c3)||(e.c3="*null"),t.exists(e.c4)||(e.c4="*null"),t.exists(e.c6)||(e.c6="*null"),e}function c(e){return g>0&&e>=g?v+=e-g:v=0,v}function l(e){S.getState()!=s.IDLE&&S.getState()!=s.PAUSED?S.notify(i.END,c(e)):S.getState()==s.PAUSED&&S.notify(i.END,v)}function p(e){return _("ns_st_ci",m,e)&&_("c3",m,e)&&_("c4",m,e)&&_("c6",m,e)}function _(e,n,i){if(t.exists(e)&&t.exists(n)&&t.exists(i)){var s=n[e],r=i[e];return t.exists(s)&&t.exists(r)&&s===r}return!1}function d(e,n){l(e),E++;var s={ns_st_cn:E,ns_st_pn:"1",ns_st_tp:"0"};t.extend(s,n),S.setClip(s),m=n,g=e,v=0,S.notify(i.PLAY,v)}function f(e){var n=+new Date;l(n),E++,e=u(e);var s={ns_st_cn:E,ns_st_pn:"1",ns_st_tp:"1",ns_st_ad:"1"};t.extend(s,e),S.setClip(s),v=0,S.notify(i.PLAY,v),g=n,y=!1}function h(e,t){var n=+new Date;e=u(e),I==b.None&&(I=t),y&&I==t&&p(e)?(S.getClip().setLabels(e),S.getState()!=s.PLAYING&&(g=n,S.notify(i.PLAY,v))):d(n,e),y=!0,I=t}var E=0,g=0,v=0,m=null,y=!1,S=null,C=!1,b={None:0,AudioContent:1,VideoContent:2},I=b.None;t.extend(this,{playAdvertisement:function(){if(S){C&&console&&console.warn("Calling deprecated function 'playAdvertisement'. Please call 'playVideoAdvertisement' or 'playAudioAdvertisement' functions instead.");var e={ns_st_ct:"va"};f(e)}},playVideoAdvertisement:function(e){if(S){var n={ns_st_ct:"va"};e&&t.extend(n,e),f(n)}},playAudioAdvertisement:function(e){if(S){var n={ns_st_ct:"aa"};e&&t.extend(n,e),f(n)}},playContentPart:function(e){if(S){C&&console&&console.warn("Calling deprecated function 'playContentPart'. Please call 'playVideoContentPart' or 'playAudioContentPart' functions instead.");var n={ns_st_ct:"vc"};e&&t.extend(n,e),h(n,b.VideoContent)}},playVideoContentPart:function(e){if(S){var n={ns_st_ct:"vc"};e&&t.extend(n,e),h(n,b.VideoContent)}},playAudioContentPart:function(e){if(S){var n={ns_st_ct:"ac"};e&&t.extend(n,e),h(n,b.AudioContent)}},stop:function(){if(S){var e=+new Date;S.notify(i.PAUSE,c(e))}}}),a()};return function(e){}(o),o}()}(),e.StreamSense}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){function e(e){function t(){var e={"2cnt.net":{syncrates:[3,7,10,10,10,10,10,60]}};return e}function n(e){var t;if(e){for(var n in e)n==w&&(t=e[n]);t&&i(t.syncrates)}}function i(e){e&&(G=e)}function s(){return G}function r(e,t,n){if(void 0===H.pageContext&&(H.pageContext=H.defaultPageContext),e){var i=new v(this,e,t,n);return k.push(i),i}}function o(){setInterval(u,B),setInterval(c,U)}function a(){for(var e=0;e<k.length;++e)try{k[e].stop()}catch(e){l(e)}}function u(e){for(var t=0;t<k.length;++t)try{k[t].update(e)}catch(e){l(e)}}function c(e){for(var t=0;t<k.length;++t)try{k[t].sync(e)}catch(e){l(e)}}function l(e){E("",e)}function p(e,t){return g([[e,t]])}function _(e){return e&&void 0!=e.site?e.site:x}function d(e){}function f(){return void 0===H.pageContext.getWindowLocationURL()?"http://":"https"==H.pageContext.getWindowLocationURL().slice(0,5)?"https://ssl-":"http://"}function h(){if(!this.nlso)try{var e="";if(e=H.pageContext.getLocalStorageItem("i00"))return"&c="+e;var t="0000",n=t+Math.ceil((new Date).getTime()/1e3).toString(16)+(32768|65535*Math.random()).toString(16)+t;H.pageContext.setLocalStorageItem("i00",n)}catch(e){console.log("error"+e)}return""}function E(e,t){var n=f()+_(t)+"."+w+"/j0="+p(e,t)+"?lt="+(new Date).getTime().toString(36)+h();H.pageContext.preloadImage(n),this.debug(n)}function g(e){var t,n,i,s,r,o,a=/[+&,;=~]/g;switch(typeof e){case"string":return a.test(e)?escape(e).replace(a,function(e){var t=o[e];return t?t:e}):escape(e);case"number":return isFinite(e)?e.toString():"null";case"boolean":case"null":return e.toString();case"object":if(!e)return"null";if(t=[],"number"==typeof e.length&&!e.propertyIsEnumerable("length")){for(s=e.length,n=0;n<s;n+=1)t.push(g(e[n])||"null");return","+t.join("+")+";"}for(i in e)"string"==typeof i&&"site"!=i&&(r=g(e[i]),r&&t.push(g(i)+"="+r));return","+t.join("+")+";"}return""}function v(e,t,n,i){function s(e){var t=new Object;for(var n in e)t[n]=e[n];return t}function r(e){f.length<_.maxstates&&f.push(e)}function o(e){C=[e,e,Math.round((new Date).getTime()/1e3).toString(36)],r(C),L=!0,b=0}function a(){null!=v&&m<v.length&&(g=v[m++],_.debug("switch syncrate to "+g))}function u(e){if(!P){var t=C[1],n=t;try{n=Math.round(E.getPosition(d))}catch(e){}try{if(t==n)return void(b>=0&&(b++,b==_.pausesync&&(L=!0)));b>=_.pausesync?o(n):t<n-1?o(n):t>n?o(n):(C[1]=n,C[1]-C[0]>=g&&n-I>=g&&(L=!0,a()),b=0)}catch(e){l=!0,_.error(e)}}}function c(){P||(L=!0,P=!0,p(null))}function p(e){if(L){try{d.width&&(h.sx=d.width),d.videoWidth&&(h.sx=d.videoWidth),d.height&&(h.sy=d.height),d.videoHeight&&(h.sy=d.videoHeight)}catch(e){}void 0!==H.pageContext.getDeviceID&&void 0!==H.pageContext.getDeviceID()&&(h[H.pageContext.getDeviceID().id_name]=H.pageContext.getDeviceID().id_value),
h.uid=y,h.pst=f;var t;try{h.dur&&0!=h.dur||(h.dur=E.getDuration(d))}catch(e){}try{t=E.getMeta(d)}catch(e){}h.vt=Math.round((new Date).getTime()/1e3)-S,_.send(t,h),I=C[1]}L=!1}var _,d,f,h,E,g,v,m,y=Math.round(1e10*Math.random()).toString(36),S=Math.round((new Date).getTime()/1e3),C=[0,0,S.toString(36)],b=0,I=0,L=!0,P=!1;_=e,d=t,E=i?i:_.HTML5Adapter,h=s(n),f=new Array,f.push(C),m=0,g=e.syncrate,v=e.getSyncRates(),a(),this.update=u,this.stop=c,this.sync=p}function m(e){return{pl:"HTML 5 Video",pv:"HTML 5",sx:screen.width,sy:screen.height}}function y(e){return Math.round(e.duration)}function S(e){return e.currentTime}function C(e){return{pl:"DEF",pv:version,sx:screen.width,sy:screen.height}}function b(e){return(new Date).getTime()/1e3}function I(e){return 0}function L(e){return{pl:"MSWM",plv:e.versionInfo,sx:screen.width,sy:screen.height}}function P(e){return e.CurrentPosition?e.CurrentPosition:e.currentPosition?e.currentPosition:e.controls&&e.controls.currentPosition?e.controls.currentPosition:e.Controls&&e.Controls.currentPosition?e.Controls.currentPosition:0}function A(e){if(e.currentMedia){if(e.currentMedia.Duration)return e.currentMedia.Duration;if(e.currentMedia.duration)return e.currentMedia.duration}else if(e.CurrentMedia){if(e.CurrentMedia.duration)return e.CurrentMedia.duration;if(e.CurrentMedia.Duration)return e.CurrentMedia.Duration}}function T(e){return{pl:"RV",plv:e.GetVersionInfo(),sx:screen.width,sy:screen.height}}function O(e){return e.GetPosition()/1e3}function R(e){return e.GetLength()/1e3}function N(e,t){localStorage.setItem(e,t)}function D(e){return localStorage.getItem(e)}function M(e){(new Image).src=e}function V(){return document.location.href}this.version="2.0.0";var w="2cnt.net",B=200,U=2e3,x="default",k=new Array;this.namespace="com.kma.springstreams",this.syncrate=20,this.pausesync=6,this.maxstates=50;var H=this;this.pageContext;var G;n(t()),e&&(x=e),o(),this.getSyncRates=s,this.track=r,this.unload=a,this.doUpdate=u,this.doSync=c,this.error=l,this.debug=d,this.send=E,this.defaultPageContext={getLocalStorageItem:D,setLocalStorageItem:N,preloadImage:M,getWindowLocationURL:V},this.HTML5Adapter={getMeta:m,getPosition:S,getDuration:y},this.DefaultAdapter={getMeta:C,getPosition:b,getDuration:I},this.WMStreamAdapter={getMeta:L,getPosition:P,getDuration:A},this.RVStreamAdapter={getMeta:T,getPosition:O,getDuration:R}}return e.prototype.setPageContext=function(e){this.pageContext=e},e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,s;!function(r,o){return i=o,s="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==s&&(e.exports=s))}(this,function(){function e(e){e=e||{},this.alwaysUseHttps=!0===e.alwaysUseHttps||!1,this.forceBBCHost=!1,this._sscCookieId=void 0,this._s1CookieId=void 0,this._uidCookieId=void 0,".co.uk"===e.forceBBCHost?this.forceBBCHost=".co.uk":".com"===e.forceBBCHost&&(this.forceBBCHost=".com")}var t,n,i,s,r,o,a;return t="ckpf_sscid",n="s1",i="ckpf_uid",s="ssc.api.bbc.co.uk",r="ssc.api.bbc.com",o="b.scorecardresearch.com",a="sb.scorecardresearch.com",e.prototype.getCookie=function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},e.prototype.getLocation=function(){return window.location},e.prototype.getCookieId=function(){var e,t,n,i,o;return t=this.getSSCHostname(),n=this.getLocation(),i=t===s&&-1!==n.hostname.search(/bbc.co.uk$/),o=t===r&&-1!==n.hostname.search(/bbc.com$/),(i||o)&&(e=this.getSSCCookieId(),null!==e&&void 0!==e||(i?e=this.getS1CookieId():o&&(e=this.getUidCookieId()))),e},e.prototype.getS1CookieId=function(){return void 0===this._s1CookieValue&&(this._s1CookieValue=this.getCookie(n)),this._s1CookieValue},e.prototype.getUidCookieId=function(){return void 0===this._uidCookieValue&&(this._uidCookieValue=this.getCookie(i)),this._uidCookieValue},e.prototype.getSSCCookieId=function(){return void 0===this._sscCookieValue&&(this._sscCookieValue=this.getCookie(t)),this._sscCookieValue},e.prototype.isValidId=function(e){var t;return t=!1,"string"==typeof e&&-1!==e.search(/^[^(?!<>\s)]+$/)&&(t=!0),t},e.prototype.getAnalyticsLocation=function(e,t){var n,i,s,r,o,a;return s=this.getSSCHostname(),i=this.getLocation(),n={sscId:void 0},"string"!=typeof e&&(e=""),void 0!==t&&!1!==this.isValidId(t)||(t=this.getCookieId()),this.alwaysUseHttps||"https:"===i.protocol?n.protocol="https:":n.protocol="http:",o=-1!==e.search(/ns_alias=/),a=this.isValidId(t),o||a?n.hostname=this.getScorecardresearchHostname():n.hostname=this.getSSCHostname(),a&&(""===e?e="?ns_alias="+t:(r=e.search(/\?/)+1,e=[e.slice(0,r),"ns_alias="+t+"&",e.slice(r)].join("")),n.sscId=t),n.search=e,-1!==n.hostname.search(/scorecardresearch.com$/)?n.pathname="/p":n.pathname="/",n.href=n.protocol+"//"+n.hostname+n.pathname+n.search,n},e.prototype.getSSCHostname=function(){var e,t;return t=this.getLocation(),e=".com"===this.forceBBCHost||".co.uk"!==this.forceBBCHost&&-1===t.hostname.search(/bbc\.co\.uk$/)?r:s},e.prototype.getScorecardresearchHostname=function(){var e,t;return t=this.getLocation(),e="https:"===t.protocol?a:o},e})},function(e,t,n){var i;i=function(e){"use strict";var t=n(7),i=n(5),s={EchoClient:n(18),Media:n(9),MediaId:n(8),Environment:i,Enums:n(0),ConfigKeys:n(3),Debug:n(2),getImplementationVersion:function(){return t.VERSION}};return s}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(e){"use strict";function t(e,n,i,a){var u=this;i=i||{},s.assertContainsValue(o.ApplicationType,n,'appType should be one of Enums.ApplicationType, got "'+n+'"'),this.state={counterNameSet:!1};var c=t.ConfigGenerator.generate(i);c&&c[r.ECHO_ENABLED]||this._disable(),this._env=void 0!==a?a:new t.Environment;var p=t.Environment.getOrbCookiesPolicy();p&&p.performance===!1?this._hasOptedOutOfPerformanceReporting=!0:this._hasOptedOutOfPerformanceReporting=!1;var _;c&&"string"==typeof c[r.ECHO_DEVICE_ID]&&(_=s.trim(c[r.ECHO_DEVICE_ID]),_.length>0?(c[r.ECHO_DEVICE_ID]=_,this._deviceId=_):c[r.ECHO_DEVICE_ID]=void 0),this._setConsumers(e,n,c,this._env),c&&c[r.USE_ESS]?this._essEnabled=!0:this._essEnabled=!1,c&&c[r.ESS_HOSTNAME]&&(l.essHost=c[r.ESS_HOSTNAME]),this._liveBroker=null,this._onDemandBroker=null,this._bitrate=null,this._codec=null,this._cdn=null,this._suppressingPlayEvent=!1,this._suppressedPlayEventLabels=null,this.addLabel("bbc_id_wait","1"),t.Environment.getOrbIdCta(function(e){u.removeLabel("bbc_id_wait"),e&&"function"==typeof e.getIStatsLabels&&u.addLabels(e.getIStatsLabels())})}var i=n(2),s=n(1),r=n(3),o=n(0),a=n(25),u=n(26),c=n(4),l=n(11);return t.prototype.getComScoreDeviceId=function(){var e;return this.consumers[t.Consumers.COMSCORE]&&(e=this.consumers[t.Consumers.COMSCORE],e instanceof t.ComScoreDelegate&&"function"==typeof e.getDeviceId)?e.getDeviceId():null},t.prototype.setTraceId=function(e){this._delegate("setTraceId",[e])},t.ConfigGenerator=n(19),t.LabelCleanser=n(6),t.Util=n(1),t.ComScoreDelegate=n(21),t.SpringDelegate=n(24),t.Environment=n(5),t.prototype._setConsumers=function(e,n,i,s){if(this._isDisabled())return void(this.consumers={});this.consumers={};var o=t.LabelCleanser.cleanLabelValue("app_name",e);return this._hasOptedOutOfPerformanceReporting===!1&&(i[r.COMSCORE_ENABLED]&&(this.consumers[t.Consumers.COMSCORE]=new t.ComScoreDelegate(o,n,i,s)),i[r.BARB_ENABLED]&&(this.consumers[t.Consumers.BARB]=new t.SpringDelegate(o,n,i,s))),this},t.prototype._delegate=function(e,t){var n,i;for(n in this.consumers)n&&(i=this.consumers[n],i[e].apply(i,t));return this},t.prototype._disable=function(){return i.info("EchoClient disabled"),this._disabled=!0,this._setConsumers(),this},t.prototype._isDisabled=function(){return this._disabled},t.prototype.addLabels=function(e){return this._delegate("addLabels",[t.LabelCleanser.cleanLabels(e)]),this},t.prototype.addLabel=function(e,t){if("string"!=typeof e)return void i.error("Label key must be a string");if(null===t||"undefined"==typeof t)return void i.error("Label cannot be null/undefined");var n={};return n[e]=t,this.addLabels(n)},t.prototype.addManagedLabel=function(e,n){return this._delegate("addManagedLabel",[t.LabelCleanser.cleanLabelKey(e),t.LabelCleanser.cleanLabelValue(e,n)]),this},t.prototype.removeLabels=function(e){for(var n=[],i=0,s=e.length;i<s;i++)n.push(t.LabelCleanser.cleanLabelKey(e[i]));return this._delegate("removeLabels",[n]),this},t.prototype.removeLabel=function(e){return this.removeLabels([e])},t.prototype.setLoggedInToBBCId=function(e){return this._delegate("setLoggedInToBBCId",[e]),this},t.prototype.setLoggedOutOfBBCId=function(){return this._delegate("setLoggedOutOfBBCId"),this},t.prototype.setAppVersion=function(e){return this._delegate("setAppVersion",[e]),this},t.prototype.setCounterName=function(e){var n,i,s=t.LabelCleanser.cleanCounterName(e);for(n in this.consumers)n&&(i=this.consumers[n],i.requiresLabelCleansing()?i.setCounterName(s):i.setCounterName(e));return this.state.counterNameSet=!0,this},t.prototype.setContentLanguage=function(e){return this._delegate("setContentLanguage",[e]),this},t.prototype.getDeviceID=function(){if(this._deviceID)return this._deviceID;this.state.comscoreEventSent||i.warn("Call to getDeviceID before any events were sent, this could mean that the s1 cookie is not yet set on the client.");var e=this._env.getCookieGetter()||t.Environment._defaultGetCookie;return e("s1")},t.prototype.viewEvent=function(e,n){var i,s,r=t.LabelCleanser.cleanCounterName(e),o=t.LabelCleanser.cleanLabels(n);for(i in this.consumers)i&&(s=this.consumers[i],s.requiresLabelCleansing()?s.viewEvent(r,o):s.viewEvent(e,n));return this.state.counterNameSet=!0,this.consumers[t.Consumers.COMSCORE]&&(this.state.comscoreEventSent=!0),this},t.prototype.userActionEvent=function(e,n,s){var r=!1;return s&&s.name&&(r=!0,s.name=t.LabelCleanser.cleanCounterName(s.name)),this.state.counterNameSet||r?(this._delegate("userActionEvent",[e,n,t.LabelCleanser.cleanLabels(s)]),this.consumers[t.Consumers.COMSCORE]&&(this.state.comscoreEventSent=!0),this):(i.error('userActionEvent: Countername not set. Either pass in a "name" label or send a viewEvent/call setcounterName first'),this)},t.prototype.errorEvent=function(e,n){return this._delegate("errorEvent",[e,t.LabelCleanser.cleanLabels(n)]),this},t.prototype.setPlayerName=function(e){s.assert("string"==typeof e&&e.length>0,'setPlayerName: name must be string with length, got "'+e+'"');var n,i,r=t.LabelCleanser.cleanLabelValue("player_name",e);for(n in this.consumers)n&&(i=this.consumers[n],i.requiresLabelCleansing()?i.setPlayerName(r):i.setPlayerName(e));return this},t.prototype.setPlayerVersion=function(e){s.assert("string"==typeof e&&e.length>0,'setPlayerVersion: version must be string with length, got "'+e+'"');var n,i,r=t.LabelCleanser.cleanLabelValue("player_version",e);for(n in this.consumers)n&&(i=this.consumers[n],i.requiresLabelCleansing()?i.setPlayerVersion(r):i.setPlayerVersion(e));return this},t.prototype.setPlayerIsPopped=function(e){return s.assert("boolean"==typeof e,'setPlayerIsPopped: isPopped must be boolean, got "'+e+'"'),this._delegate("setPlayerIsPopped",[e]),this},t.prototype.setPlayerWindowState=function(e){return s.assertContainsValue(o.WindowState,e,'The window state must be set as a member of Enums.WindowState, got "'+e+'"'),this._delegate("setPlayerWindowState",[e]),this},t.prototype.setPlayerVolume=function(e){return s.assert(e<=100&&e>=0,"volume must be 0-100, got: "+e),e<=100&&e>=0&&this._delegate("setPlayerVolume",[e]),this},t.prototype.setPlayerIsSubtitled=function(e){return s.assert("boolean"==typeof e,'setPlayerIsSubtitled: isSubtitled must be a boolean, got "'+e+'"'),this._delegate("setPlayerIsSubtitled",[e]),this},t.prototype.setPlayerDelegate=function(e){e=e||{};var t,n,i,r=["getTimestamp","getPosition"],o=!1;for(n=0;n<r.length;n++)t=r[n],i=e.hasOwnProperty(t)&&"function"==typeof e[t],s.assert(i,'The player delegate must implement "'+t+'"'),i||(o=!0);return o||(this._playerDelegate=e),this},t.prototype.setMedia=function(e){this._clearMedia();var t=e.getClone();if(!this.state.counterNameSet)return void i.error("setMedia: Must have a countername set or view event sent first");this.media=t,this.addLabel(c.ESS_ENABLED,this._essEnabled?"true":"false");var n=o.MediaConsumptionMode.LIVE;this.media.getMediaConsumptionMode()===n?this._initLiveBroker():this._initOnDemandBroker(),this._delegate("setMedia",[this.media])},t.prototype.liveMediaUpdate=function(e,t,n){e&&(this._suppressingPlayEvent=!1,e.setBitrate(this._bitrate||this.media.getBitrate()),e.setCodec(this._codec||this.media.getCodec()),e.setCDN(this._cdn||this.media.getCDN()),this.media=e,this._delegate("liveMediaUpdate",[e,t,n]))},t.prototype.setMediaLength=function(e){return this.media?this.media.isOnDemand()?(e=this._cleanPosition(e),"number"!=typeof e?(i.error("setMediaLength: Length must be a positive number"),this):(this._delegate("setMediaLength",[e]),this)):(i.error("setMediaLength: Length should be set to zero prior to passing the media object to Echo for live media"),this):(i.error("setMediaLength: Must call setMedia first"),this)},t.prototype.setMediaBitrate=function(e){return s.assert(e>0,'setMediaBitrate: bitrate must be > 0, got "'+e+'"'),this._bitrate=e,this._delegate("setMediaBitrate",[e]),this},t.prototype.setMediaCodec=function(e){return s.assert("string"==typeof e,'setMediaCodec: must be string value, got "'+typeof e+'"'),this._codec=t.LabelCleanser.cleanLabelValue(c.MEDIA_CODEC,e),this._delegate("setMediaCodec",[this._codec]),this},t.prototype.setMediaBufferLength=function(e){s.assert(e>0,"Buffer length value must be greater than or equal to zero. Not valid: "+e),this._avEventsEnabled()&&this._delegate("setMediaBufferLength",[e])},t.prototype.setMediaDownloadBitrate=function(e){s.assert(e>0,"Download bitrate value must be greater than zero. Not valid: "+e),this._avEventsEnabled()&&this._delegate("setMediaDownloadBitrate",[e])},t.prototype.setMediaSelectorProperties=function(e,t,n){this.media.setMediaSelectorProperties(e,t,n),this._delegate("setMediaSelectorProperties",[e,t,n])},t.prototype.setMediaCDN=function(e){return s.assert("string"==typeof e,'setMediaCDN: must be string value, got "'+typeof e+'"'),this._cdn=t.LabelCleanser.cleanLabelValue(c.MEDIA_CDN,e),this._delegate("setMediaCDN",[this._cdn]),this},t.prototype.setEssSuccess=function(e){this.addLabel(c.ESS_SUCCESS,e?"true":"false")},t.prototype.setEssError=function(e,t){this.addLabel(c.ESS_ERROR,e.toString().toLowerCase()),e.toString()===o.EssError.STATUS_CODE.toString()&&this.addLabel(c.ESS_STATUS_CODE,t),this._delegate("liveEnrichmentFailed")},t.prototype.avErrorEvent=function(e,t){this._avEventsEnabled()&&this._delegate("avErrorEvent",[e,t])},t.prototype._avEventsEnabled=function(){return s.assert(!!this.media,"setMedia() must be called prior to this method")&&s.assert(!!this._playerDelegate,"setPlayerDelegate not called or not configured correctly")},t.prototype.getLiveBroker=function(){return this._liveBroker},t.prototype._initLiveBroker=function(){this._avEventsEnabled()&&this.media.getMediaConsumptionMode()===o.MediaConsumptionMode.LIVE&&(this._liveBroker=new a(this._playerDelegate,this.media,this,this._env,this._essEnabled),this._delegate("setBroker",[this._liveBroker]))},t.prototype.getOnDemandBroker=function(){return this._onDemandBroker},t.prototype._initOnDemandBroker=function(){this._avEventsEnabled()&&this.media.getMediaConsumptionMode()!==o.MediaConsumptionMode.LIVE&&(this._onDemandBroker=new u(this._playerDelegate,this.media,this),this._delegate("setBroker",[this._onDemandBroker]))},t.prototype._cleanPosition=function(e){return void 0!==e&&null!==e&&(e=Math.floor(e)),(void 0===e||isNaN(e)||!isFinite(e)||e<0)&&(e=0),e},t.prototype.avPlayEvent=function(e,n){var i,s,r=1e4;if(this._avEventsEnabled()){if(i=this.media.isLive(),!i&&this._isPlaying&&this._onDemandBroker&&(s=this._onDemandBroker.getPosition(),(0===this._previousPlayPosition||Math.abs(e-s)>r)&&this._delegate("avPauseEvent",[s,{}])),this._isPlaying=!0,i&&this._liveBroker)e=this._liveBroker.getPosition(),this._liveBroker.start();else if(!i&&this._onDemandBroker){if(e=this._cleanPosition(e),this._previousPlayPosition=e,this._positionExceedsMediaLength(e))return;this._onDemandBroker.setPosition(e),this._onDemandBroker.start()}return i&&this.media.isEssEnriched()&&this._suppressingPlayEvent?this._suppressedPlayEventLabels=n:this._delegate("avPlayEvent",[e,t.LabelCleanser.cleanLabels(n)]),this.consumers[t.Consumers.COMSCORE]&&(this.state.comscoreEventSent=!0),this}},t.prototype._avNavigationEvent=function(e,n,i,s){this._avEventsEnabled()&&(this._isPlaying=!1,this.media.isLive()?(this._liveBroker&&(this._liveBroker.stop(),n=this._liveBroker.getPosition()),this.media.isEssEnriched()&&!this._suppressingPlayEvent&&(this._suppressingPlayEvent=!0)):this._onDemandBroker&&(n=this._cleanPosition(n),n=this._preventPositionExceedingMediaLength(n),this._onDemandBroker.stop()),"avRewindEvent"===e||"avFastForwardEvent"===e?this._delegate(e,[n,s,t.LabelCleanser.cleanLabels(i)]):this._delegate(e,[n,t.LabelCleanser.cleanLabels(i)]))},t.prototype.avPauseEvent=function(e,t){return this._avNavigationEvent("avPauseEvent",e,t),this},t.prototype.avBufferEvent=function(e,t){return this._avNavigationEvent("avBufferEvent",e,t),this},t.prototype.avEndEvent=function(e,t){return this._avNavigationEvent("avEndEvent",e,t),this},t.prototype.avRewindEvent=function(e,t,n){return this._avNavigationEvent("avRewindEvent",e,n,t),this},t.prototype.avFastForwardEvent=function(e,t,n){return this._avNavigationEvent("avFastForwardEvent",e,n,t),this},t.prototype.avSeekEvent=function(e,t){return this._avNavigationEvent("avSeekEvent",e,t),this},t.prototype.avUserActionEvent=function(e,n,i,s){if(this._avEventsEnabled()){this._liveBroker?i=this._liveBroker.getPosition():(i=this._cleanPosition(i),i=this._preventPositionExceedingMediaLength(i));var r=t.LabelCleanser.cleanLabels(s);return this._delegate("avUserActionEvent",[e,n,i,r]),this}},t.prototype.releaseSuppressedPlay=function(){return this._suppressingPlayEvent&&(this._suppressingPlayEvent=!1,this.avPlayEvent(this._liveBroker.getPosition(),this._suppressedPlayEventLabels)),this},t.prototype._clearMedia=function(){this.removeLabel(c.MEDIA_TIMESTAMP),this.removeLabel(c.ESS_ENABLED),this.removeLabel(c.ESS_ENRICHED),this.removeLabel(c.ESS_SUCCESS),this.removeLabel(c.ESS_ERROR),this.removeLabel(c.ESS_STATUS_CODE),null!==this.media&&(this.media=null),this._liveBroker instanceof a&&(this._liveBroker.stop(),this._liveBroker=null),this._onDemandBroker instanceof u&&(this._onDemandBroker.stop(),this._onDemandBroker=null),this._isPlaying=void 0,this._previousPlayPosition=void 0},t.prototype._positionExceedsMediaLength=function(e){return!!(this.media&&this.media.length>0&&e>=this.media.length-1e3)},t.prototype._preventPositionExceedingMediaLength=function(e){return this._positionExceedsMediaLength(e)?this.media.length:e},t.Consumers={COMSCORE:1,BARB:2},t}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(e){"use strict";function t(e){return"string"==typeof e&&e.length>0}function i(e){return e.match(/[a-zA-Z]+/)}function s(e){return"string"==typeof e&&(e=e.toUpperCase(),_.ReportingProfiles.hasOwnProperty(e))}function r(e){return d.assert("boolean"==typeof e[h.ECHO_ENABLED],'Config: "enabled" must be boolean, got '+e[h.ECHO_ENABLED])&&d.assert(null===e[h.ECHO_DEVICE_ID]||"string"==typeof e[h.ECHO_DEVICE_ID]&&e[h.ECHO_DEVICE_ID].length,"ECHO.DEVICE_ID must be an non-empty string")}function o(e){if(e[h.COMSCORE_ENABLED]===!1)return!0;if(!t(e[h.REPORTING_PROFILE])){if(!t(e[h.COMSCORE_HOST]))return p.error("Config Error: Must have config value for COMSCORE_HOST or REPORTING_PROFILE"),!1;if("scorecardresearch.com"!==e[h.COMSCORE_HOST]&&"sa.bbc.co.uk"!==e[h.COMSCORE_HOST])return p.error("Config Error: KEYS.COMSCORE_HOST Should be one of scorecardresearch.com or sa.bbc.co.uk"),!1}return s(e[h.REPORTING_PROFILE])?d.assert("boolean"==typeof e[h.COMSCORE_ENABLED],'ComScore config: "ENABLED" must be boolean'):(p.error("Config Error: KEYS.REPORTING_PROFILE Invalid reporting profile specified"),!1)}function a(e){return e[h.BARB_ENABLED]===!1||(t(e[h.BARB_SITE_CODE])?i(e[h.BARB_SITE_CODE])?"boolean"==typeof e[h.BARB_DEBUG]||(p.error("Config Error: KEYS.BARB_DEBUG must be a boolean"),!1):(p.error("Config Error: KEYS.BARB_SITE_CODE must match [a-zA-Z]"),!1):(p.error("Config Error: KEYS.BARB_SITE_CODE must have a value"),!1))}function u(e){var t=e[h.SSC_HOSTNAME];return"boolean"!=typeof e[h.USE_SSC]?(p.error("Config Error: KEYS.USE_SSC must be boolean"),!1):null===t||".com"===t||".co.uk"===t||(p.error("Config Error: SSC_HOSTNAME must be one of .com, .co.uk or null"),!1)}function c(e){return"string"==typeof e&&(e=e.toUpperCase(),_.ReportingProfiles.hasOwnProperty(e))?_.ReportingProfiles[e]:null}function l(e){var t;e=e||{},e[h.REPORTING_PROFILE]&&(t=c(e[h.REPORTING_PROFILE])),t||(t=c("PUBLIC_SERVICE"));var n=d.extend(E,!0,t,e||{},g);return r(n)&&o(n)&&a(n)&&u(n)?n:null}var p=n(2),_=n(0),d=n(1),f=n(7),h=n(3),E={};E[h.ECHO_ENABLED]=!0,E[h.ECHO_DEVICE_ID]=null,E[h.REPORTING_PROFILE]="PUBLIC_SERVICE",E[h.COMSCORE_ENABLED]=!0,E[h.BARB_ENABLED]=!1,E[h.BARB_DEBUG]=!1,E[h.BARB_SITE_CODE]="bbcdotcom",E[h.TEST_SERVICE_ENABLED]=!1,E[h.USE_ESS]=!1,E[h.ESS_HOSTNAME]="ess.api.bbci.co.uk",E[h.USE_SSC]=!1,E[h.SSC_HOSTNAME]=null;var g={};return g[h.ECHO_NAME]=f.NAME,g[h.ECHO_VERSION]=f.VERSION,{defaultConfig:E,fixedConfig:g,generate:l}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,s;i=[n(4)],s=function(e){"use strict";function t(e,t,n){this._persistantLabels={},this._urlParams="",this._cut="",this._httpGet=e,this._eventCount=0,this._isApp=t,this._isScorecardDomain=n===!0}return t.IS_ECHO_APP_TAG=!0,t.URL_LIMIT=2048,t.prototype.setPixelURL=function(e){this._url=this._makeBaseUrl(e)},t.prototype.setCustomerC2=function(t){this.setLabel(e.COMSCORE_CUSTOMER,t)},t.prototype.setLabel=function(e,t){null===t?this.removeLabel(e):this._persistantLabels[e]=t},t.prototype.removeLabels=function(e){for(var t in e)"undefined"!=typeof this._persistantLabels[e[t]]&&delete this._persistantLabels[e[t]]},t.prototype.removeLabel=function(e){"undefined"!=typeof this._persistantLabels[e]&&delete this._persistantLabels[e]},t.prototype.view=function(e){this.send("view",e)},t.prototype.hidden=function(e){this.send("hidden",e)},t.prototype.send=function(e,t,n){var i,s,r=this._persistantLabels,o={};this._eventCount++;for(s in r)o[s]=r[s];for(s in t)o[s]=t[s];o.ns_type=e,this._isApp&&(o.ns_ap_ev=e,o.ns_ap_ec=this._eventCount),o[this._isApp?"ns_ts":"ns__t"]=+new Date,i=this._createUrl(o),this._httpGet(i,n)},t.prototype._createUrl=function(t){var n,i=window.encodeURIComponent||escape,s=this._url;this._urlParams="",this._cut="",t.hasOwnProperty("name")&&this._addUrlParam("name",t.name);for(n in t)"name"!==n&&"ns_referrer"!==n&&this._addUrlParam(n,t[n]);return t.hasOwnProperty("ns_referrer")&&this._addUrlParam(this._isScorecardDomain?e.ENV_REFERRER:"ns_referrer",t.ns_referrer),s+=this._urlParams,this._cut.length?s+="ns_cut="+i(this._cut.replace(/&$/,"")):s=s.replace(/&$/,""),s},t.prototype._addUrlParam=function(e,n){var i=window.encodeURIComponent||escape,s=i(e)+"="+i(n)+"&",r=t.URL_LIMIT-8;this._url.length+this._urlParams.length+s.length<r?this._urlParams+=s:this._cut+=s},t.prototype._makeBaseUrl=function(e){for(var t=-1,n=e.charAt(e.length-1),i=0,s=e.length;i<s;i++)"?"===e.charAt(i)&&(t=i);return t===-1?e+="?":"?"!==n&&"&"!==n&&(e+="&"),e},t}.apply(t,i),!(void 0!==s&&(e.exports=s))},function(e,t,n){var i;i=function(e){"use strict";function t(){return-1}function i(e){var t="https:"===e?"s":"";return e+"//"+t+"b."+b+"/p?"}function s(e,t){return e+"//"+C+"/"+t+"/s"}function r(e,t,n){return e===b?i(t):s(t,n)}function o(e){var t=null===e?m:e;return t}function a(e){return null!==e&&e.isValueValid()?e.getValue():m}function u(e){var t=e.getMediaConsumptionMode(),n=e.getServiceIdObject(),i=e.getVersionIdObject(),s=e.getClipIdObject(),r=e.getEpisodeIdObject(),o=e.getVpIdObject();return t===v.MediaConsumptionMode.LIVE&&e.isEssEnriched()===!0&&i.isValueValid()?i:t===v.MediaConsumptionMode.LIVE&&n.isValueValid()?n:i.isValueValid()?i:s.isValueValid()?s:r.isValueValid()?r:o.isValueValid()?o:n.isValueValid()?n:null}function c(e){var t=u(e),n=e.getVersionIdObject(),i=e.getEpisodeIdObject(),s=e.getClipIdObject();if(null!==t){var r=t.getIdType();if(e.isLive()){if(r===v.MediaIdType.SERVICE||e.isEssEnriched())return!1}else{if(!(r!==v.MediaIdType.SERVICE||n.isValueSet()||i.isValueSet()||s.isValueSet()))return!0;if(r!==v.MediaIdType.VPID)return!1}}return!0}function l(e){var t={},n=u(e);return t[d.PLAYLIST_NAME]=null===n?m:n.getValue(),t}function p(e){var t={},n=u(e),i=o(e.getAvType()),s=o(e.getLength()),r=o(e.getRetrievalType()),l=e.getBitrate(),p=e.getScheduleMode(),_=e.getCodec(),f=e.getCDN();t[d.MEDIA_PART_NUMBER]=1,t[d.MEDIA_TOTAL_PARTS]=1,t[d.MEDIA_LENGTH]=s,t[d.MEDIA_MEDIUM]=i,t[d.MEDIA_RETRIEVAL_TYPE]=r;var h=e.getMediaConsumptionMode();null===h?(t[d.MEDIA_STREAM_TYPE]=m,t[d.MEDIA_LIVE_OR_ONDEMAND]=m):e.isLive()||i!==m?e.isOnDemand()||e.isDownload()?(t[d.MEDIA_STREAM_TYPE]=e.isVideo()?"vod":"aod",t[d.MEDIA_LIVE_OR_ONDEMAND]="on-demand"):(e.isEssEnriched()?t[d.ESS_ENRICHED]="true":(t[d.ESS_ENRICHED]="false",t[d.MEDIA_IS_LIVE]="1"),t[d.MEDIA_STREAM_TYPE]="live",t[d.MEDIA_LIVE_OR_ONDEMAND]="live"):t[d.MEDIA_STREAM_TYPE]=m,l>0&&(t[d.MEDIA_BITRATE]=1e3*l),null!==p&&(t[d.MEDIA_SCHEDULE_INDICATOR]=p),null!==_&&(t[d.MEDIA_CODEC]=_),null!==f&&(t[d.MEDIA_CDN]=f);var E=e.getVersionIdObject(),g=e.getServiceIdObject(),v=e.getClipIdObject(),y=e.getEpisodeIdObject();if(t[d.MEDIA_PID]=a(n),e.isLive()&&!e.getServiceId()&&e.isEssEnriched()===!1&&(e.getVersionId()||e.getVpId())){var S=e.getVersionId()||e.getVpId();t[d.MEDIA_PID]="unverified_"+S}return E.isValueSet()&&(t[d.MEDIA_VERSION_ID]=a(E)),g.isValueSet()&&(t[d.MEDIA_SERVICE_ID]=a(g)),v.isValueSet()&&(t[d.MEDIA_CLIP_ID]=a(v)),y.isValueSet()&&(t[d.MEDIA_EPISODE_ID]=a(y)),c(e)&&(t[d.MEDIA_AMBIGUOUS_ID]="1"),t}function _(e,t,n,i){var s,o,a,u,c,l,p,g,y=n[f.COMSCORE_SITE];this._deviceId=null,this._broker=null,this.media=null,this.SSPlayerEvent=_.StreamSense.PlayerEvents,this.SSPlayerState=_.StreamSense.InternalStates,this._clips=[],u=n[f.COMSCORE_HOST],y=n[f.COMSCORE_SITE],this.useSsc=n[f.USE_SSC]===!0&&"sa.bbc.co.uk"!==u,this._deviceId=n[f.ECHO_DEVICE_ID]||void 0,this.useSsc!==!0||this._deviceId||(l=_._createSscHelper({forceBBCHost:n[f.SSC_HOSTNAME]}),this._deviceId=l.getCookieId()),E.containsValue(v.ApplicationType,t)||(t=m),s=r(u,i.getProtocol(),y),this.useSsc!==!0||this._deviceId||(s=l.getLocation().protocol+"//"+l.getSSCHostname()),n[f.TEST_SERVICE_ENABLED]===!0&&(o=s,s=n[f.TEST_SERVICE_URL]+"/comscore"),this._isApp=!E.containsValue(I,t),c=i.getHttpGet(),a=u===b,this._isUsingComscoreOTTLibrary=_.AppTag&&_.AppTag.ns_,this._isUsingComscoreOTTLibrary?(this.appTag=_.AppTag.ns_.comScore,this.appTag.setPlatformAPI(_.AppTag.ns_.PlatformAPIs.html5),this.appTag.setPublisherSecret(n[f.COMSCORE_PUBLISHER_SECRET]),this.appTag.setAppContext()):this.appTag=new _.AppTag(c||h._defaultHttpGet,this._isApp,a),this.ss=new _.StreamSense({},s),c&&this.ss.setHttpGet(c),this.appTag.setPixelURL(s),a&&(this.appTag.setCustomerC2(n[f.COMSCORE_CUSTOMER_ID]),this.addLabel(d.COMSCORE_C1,"2"),this.addLabel(d.COMSCORE_SITE,y)),this._deviceId?this.addLabel(d.DEVICE_ID,this._deviceId):this.useSsc||"sa.bbc.co.uk"!==u||(this._deviceId=S.getCookieValueByName("s1")),n[f.TEST_SERVICE_ENABLED]===!0&&this.addLabel(d.COMSCORE_ENDPOINT,o),this.addLabel(d.BBC_APPLICATION_NAME,e),this.addLabel(d.BBC_APPLICATION_TYPE,t),this.addLabel(d.BBC_MEASUREMENT_LIB_NAME,n[f.ECHO_NAME]),this.addLabel(d.BBC_MEASUREMENT_LIB_VERSION,n[f.ECHO_VERSION]),this._isApp?(this._isUsingComscoreOTTLibrary?this.appTag.setAppName(e):this.addLabel(d.APP_NAME,e),this.addLabel(d.APP_PLATFORM_NAME,i.getPlatformName()),this.addLabel(d.APP_PLATFORM_RUNTIME,i.getPlatformRuntimeEnvironment()),this.addLabel(d.APP_OS_VERSION,i.getPlatformOSVersion()),this.addLabel(d.APP_DEVICE_NAME,i.getDeviceName()),this.addLabel(d.APP_SCREEN_RESOLUTION,i.getScreenResolution()),this.addLabel(d.APP_LANGUAGE,i.getLanguage())):this.addLabel(d.WEB_SCREEN_RES,i.getScreenResolution()),this.addLabel(d.ENV_CHAR_SET,i.getCharSet()),this.addLabel(d.ENV_TITLE,i.getTitle()),this.addLabel(d.ENV_URL,i.getURL()),this.addLabel(d.ENV_REFERRER,i.getReferrer()),n[f.ECHO_TRACE]&&this.setTraceId(n[f.ECHO_TRACE]),p=h.getOrbCookiesPolicy(),p&&(g="ad"+(p.ads?"1":"0")+"ps"+(p.personalisation?"1":"0")+"pf"+(p.performance?"1":"0"),this.addLabel(d.COOKIE_POLICY,g),p.performance||this.addLabel(d.NO_COOKIES,"1")),this.addLabel(v.ManagedLabels.BBC_SITE,m),this._mediaIsLive=null}var d=n(4),f=n(3),h=n(5),E=n(1),g=n(28),v=n(0),m="invalid-data",y=n(16),S=n(12),C="sa.bbc.co.uk/bbc",b="scorecardresearch.com",I=[v.ApplicationType.WEB,v.ApplicationType.MOBILE_WEB,v.ApplicationType.RESPONSIVE],L=[d.NO_COOKIES];_.prototype.getDeviceId=function(){return this._deviceId},_.prototype._buildStreamSenseClip=function(e){var t,n=p(e),i=n[d.MEDIA_PID];for(t=0;t<this._clips.length;t++)if(this._clips[t][d.MEDIA_PID]===i)return this._clips[t];return n[d.MEDIA_CLIP_NUMBER]=this._clips.length+1,this._clips.push(n),n},_.prototype.setTraceId=function(e){this.addLabel(f.ECHO_TRACE,e)},_._createSscHelper=function(e){return new y(e||{})},_.StreamSense=n(14),_.AppTag=n(20);var P="<"+L.join("><")+">";return _.prototype._isExcludedLabel=function(e){return this.useSsc===!0&&!!P.match(new RegExp("<"+e+">"))},_.prototype.addLabels=function(e){if("object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&this.addLabel(t,e[t])},_.prototype.addLabel=function(e,t){this._isExcludedLabel(e)!==!0&&(this.appTag.setLabel(e,t),this.ss.setLabel(e,t))},_.prototype.addManagedLabel=function(e,t){var n=g.isValidManagedLabel(e,t),i=n?t:m;for(var s in v.ManagedLabels)v.ManagedLabels[s]===e&&this.addLabel(e,i)},_.prototype.removeLabels=function(e){for(var t=0,n=e.length;t<n;t++)this.removeLabel(e[t])},_.prototype.removeLabel=function(e){this.appTag.setLabel(e,null),this.ss.setLabel(e,null)},_.prototype.setLoggedInToBBCId=function(e){this.addLabel(d.BBC_ID_LOGGED_IN,"1"),e&&e.length>0?this.addManagedLabel(v.ManagedLabels.BBC_HASHED_ID,e):this.removeLabel(v.ManagedLabels.BBC_HASHED_ID)},_.prototype.setLoggedOutOfBBCId=function(){this.removeLabels([d.BBC_ID_LOGGED_IN,v.ManagedLabels.BBC_HASHED_ID])},_.prototype.setAppVersion=function(e){"function"==typeof this.appTag.setAppVersion?this.appTag.setAppVersion(e):e&&this._isApp?this.addLabel(d.BBC_APPLICATION_VERSION,e.toString()):e&&this.addLabel(d.APP_VERSION,e.toString())},_.prototype.setCounterName=function(e){this.addLabel(d.BBC_COUNTER_NAME,e)},_.prototype.setContentLanguage=function(e){this.addLabel(d.BBC_LANGUAGE,e)},_.prototype.viewEvent=function(e,t){this.addLabel(d.BBC_COUNTER_NAME,e);var n=E.extend(t,!0,d.ECHO_EVENT_NAME,"view");n.name=e,this.appTag.view(n)},_.prototype.errorEvent=t,_.prototype.userActionEvent=function(e,t,n){var i=E.extend(n,!0,d.USER_ACTION_TYPE,e,d.USER_ACTION_NAME,t,d.ECHO_EVENT_NAME,"userAct");this.appTag.hidden(i)},_.prototype.setPlayerName=function(e){this.addLabel(d.PLAYER_NAME,e)},_.prototype.setPlayerVersion=function(e){this.addLabel(d.PLAYER_VERSION,e)},_.prototype.setPlayerIsPopped=function(e){this.ss.setLabel(d.PLAYER_POPPED,e?1:0)},_.prototype.setPlayerWindowState=function(e){this.ss.setLabel(d.PLAYER_WINDOW_STATE,e)},_.prototype.setPlayerVolume=function(e){this.ss.setLabel(d.PLAYER_VOLUME,e)},_.prototype.setPlayerIsSubtitled=function(e){this.ss.setLabel(d.PLAYER_SUBTITLED,e?1:0)},_.prototype.setBroker=function(e){return this._broker=e,this},_.prototype.setMedia=function(e){this.clearMedia(),this.media=e;var t=this._buildStreamSenseClip(this.media),n=l(this.media);this._mediaIsLive=!e.isOnDemand(),this.ss.setPlaylist(n),this.ss.setClip(t)},_.prototype.liveMediaUpdate=function(e,t,n){E.assert("number"==typeof t,"newPosition must be a number"),
E.assert("number"==typeof n,"oldPosition must be a number"),this.media=e;var i=this._buildStreamSenseClip(e),s={};s[d.ECHO_EVENT_NAME]="avEnd",this.ss.notify(this.SSPlayerEvent.END,s,n),this.ss.setClip(i),s={},s[d.ECHO_EVENT_NAME]="avPlay",this.ss.notify(this.SSPlayerEvent.PLAY,s,t)},_.prototype.liveEnrichmentFailed=t,_.prototype.avErrorEvent=t,_.prototype.setMediaBufferLength=t,_.prototype.setMediaDownloadBitrate=t,_.prototype.setMediaSelectorProperties=t,_.prototype.setMediaLength=function(e){e>=0&&null!==this.media&&this.ss.getClip().setLabel(d.MEDIA_LENGTH,e)},_.prototype.setMediaBitrate=function(e){e>0&&null!==this.media&&(e*=1e3,this.ss.getClip().setLabel(d.MEDIA_BITRATE,e))},_.prototype.setMediaCodec=function(e){this.ss.getClip().setLabel(d.MEDIA_CODEC,e)},_.prototype.setMediaCDN=function(e){this.ss.getClip().setLabel(d.MEDIA_CDN,e)},_.prototype.avPlayEvent=function(e,t){var n=E.extend(t,!0,d.ECHO_EVENT_NAME,"avPlay");this.media.isLive()&&this.media.isEssEnriched()===!1&&(e=0),this.ss.notify(this.SSPlayerEvent.PLAY,n,e)},_.prototype.avPauseEvent=function(e,t){var n=E.extend(t,!0,d.ECHO_EVENT_NAME,"avPause"),i=this.media.isLive();i&&this.media.isEssEnriched()===!1?e=0:!i&&this._broker&&0===e&&(e=this._broker.getCurrentIntervalMaxPosition()),this.ss.notify(this.SSPlayerEvent.PAUSE,n,e)},_.prototype.avBufferEvent=function(e,t){this.media.isLive()&&this.media.isEssEnriched()===!1&&(e=0),this.ss.notify(this.SSPlayerEvent.BUFFER,{},e)},_.prototype.avEndEvent=function(e,t){var n=E.extend(t,!0,d.ECHO_EVENT_NAME,"avEnd",d.PLAYLIST_END,1);this.media.isLive()&&this.media.isEssEnriched()===!1&&(e=0),this.ss.notify(this.SSPlayerEvent.END,n,e),this.clearMedia()},_.prototype.avRewindEvent=function(e,t,n){var i=E.extend(n,!0,d.ECHO_EVENT_NAME,"avRW",d.EVENT_TRIGGERED_BY_USER,"rewind",d.REWIND_FF_RATE,t);this.media.isLive()&&this.media.isEssEnriched()===!1&&(e=0),this.ss.notify(this.SSPlayerEvent.PAUSE,i,e)},_.prototype.avFastForwardEvent=function(e,t,n){var i=E.extend(n,!0,d.ECHO_EVENT_NAME,"avFF",d.EVENT_TRIGGERED_BY_USER,"fastforward",d.REWIND_FF_RATE,t);this.media.isLive()&&this.media.isEssEnriched()===!1&&(e=0),this.ss.notify(this.SSPlayerEvent.PAUSE,i,e)},_.prototype.avSeekEvent=function(e,t){var n=E.extend(t,!0,d.ECHO_EVENT_NAME,"avSeek",d.EVENT_TRIGGERED_BY_USER,"seek");this.media.isLive()&&this.media.isEssEnriched()===!1&&(e=0),this.ss.notify(this.SSPlayerEvent.PAUSE,n,e)},_.prototype.avUserActionEvent=function(e,t,n,i){var s=E.extend(i,!0,d.ECHO_EVENT_NAME,"avUserAct",d.STREAMSENSE_CUSTOM_EVENT_TYPE,e,d.USER_ACTION_TYPE,e,d.USER_ACTION_NAME,t);this.media.isLive()&&this.media.isEssEnriched()===!1&&(n=0),this.ss.customNotify(s,n)},_.prototype.clearMedia=function(){this._clips=[],null!==this.media&&(this.ss.getState()===this.SSPlayerState.PLAYING&&this.avEndEvent(0),this.media=null)},_.prototype.requiresLabelCleansing=function(){return!0},_}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){!(e.exports={STREAM:"stream",PID:"cq",WIDTH:"sx",HEIGHT:"sy",PLAYER_DESC:"pl",PLAYER_VERSION:"plv"})},function(e,t,n){var i;i=function(){"use strict";function e(e,t){this.namespace=e,this.env=t}return e.prototype.preloadImage=function(e){var t=this.env.getHttpGet();return t(e)},e.prototype.getLocalStorageItem=function(e){var t=this.env.getGetLocalStorageItem();return t(e)},e.prototype.setLocalStorageItem=function(e,t){var n=this.env.getSetLocalStorageItem();return n(e,t)},e.prototype.getWindowLocationURL=function(){return this.env.getURL()},e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(e){"use strict";function t(){return-1}function i(e,t,n,i){this._sensors=null,this._broker=null,this._media=null,this._meta={},this._stream=null,this._env=i,this._siteCode=n[r.BARB_SITE_CODE],this._debug=n[r.BARB_DEBUG],this._traceId=null,this._isPlaying=!1,this._isEssEnabled=!1,n[r.ECHO_TRACE]&&this.setTraceId(n[r.ECHO_TRACE]),n[r.USE_ESS]&&(this._isEssEnabled=!0)}var s=n(22),r=n(3),o=n(2),a=n(0),u=n(23);return i.prototype.setTraceId=function(e){this._traceId=e},i.SpringStreams=n(15),i.prototype.addLabels=t,i.prototype.addLabel=t,i.prototype.addManagedLabel=t,i.prototype.removeLabels=t,i.prototype.removeLabel=t,i.prototype.setLoggedInToBBCId=t,i.prototype.setLoggedOutOfBBCId=t,i.prototype.setAppVersion=t,i.prototype.setCounterName=t,i.prototype.setESSEnabled=t,i.prototype.viewEvent=t,i.prototype.errorEvent=t,i.prototype.userActionEvent=t,i.prototype.setPlayerName=function(e){this._meta[s.PLAYER_DESC]=e},i.prototype.setPlayerVersion=function(e){this._meta[s.PLAYER_VERSION]=e},i.prototype.setPlayerIsPopped=t,i.prototype.setPlayerWindowState=t,i.prototype.setPlayerVolume=t,i.prototype.setPlayerIsSubtitled=t,i.prototype.setBroker=function(e){return this._broker=e,this},i.prototype.setMedia=function(e){this.clearMedia(),this._media=e.getClone()},i.prototype.setMediaLength=function(e){this._media.setLength(e)},i.prototype.setMediaBitrate=t,i.prototype.setMediaCodec=t,i.prototype.setMediaCDN=t,i.prototype.liveMediaUpdate=function(e){this._media=e.getClone(),this._isPlaying&&this._startTracking()},i.prototype.liveEnrichmentFailed=function(){this._media.getServiceId()||this._media.setServiceId("no-service-id-found"),this._isPlaying&&this._startTracking()},i.prototype.avPlayEvent=function(e,t){this.isValidMedia()&&this._broker&&(this._initSensors(),this._isPlaying=!0,this._media.isLive()&&!this._media.getServiceId()?this._isEssEnabled&&(this._media.getVersionId()||this._media.getVpId())||(this._media.setServiceId("invalid-data"),this._startTracking()):this._startTracking())},i.prototype._initSensors=function(){if(null===this._sensors){if(this._sensors=new i.SpringStreams(this._siteCode),null!==this._env.getSetLocalStorageItem()&&null!==this._env.getGetLocalStorageItem()&&null!==this._env.getHttpGet()){o.info("Using custom PageContext for BARB");var e=new u("com.kma.springstreams",this._env);this._sensors.setPageContext(e)}this._debug&&(this._sensors.debug=function(e){o.info("Spring DEBUG: "+e)})}},i.prototype._startTracking=function(){if(null===this._stream){var e=this._getAttributes(),t=e[s.PID]||" ";this._stream=this._sensors.track(t,e,this._getAdaptor())}},i.prototype._getMostPrecedentIdObject=function(){var e=this._media.getVersionIdObject(),t=this._media.getEpisodeIdObject(),n=this._media.getClipIdObject(),i=this._media.getVpIdObject(),s=this._media.getServiceIdObject();return e.isValueValid()?e:t.isValueValid()?t:n.isValueValid()?n:i.isValueValid()?i:s.isValueValid()?s:null},i.prototype._getAttributes=function(){var e=this._media,t={};if(this._traceId&&(t[r.ECHO_TRACE]=this._traceId),!e.isLive()){var n=this._getMostPrecedentIdObject();null!==n&&(t[s.PID]=n.getValue())}return e.isOnDemand()?t[s.STREAM]="od":e.isDownload()?t[s.STREAM]="dwn":e.isLive()&&e.getServiceIdObject().isValueValid()&&(t[s.STREAM]="live/"+e.getServiceId()),t},i.prototype._getAdaptor=function(){var e,t=this;return e=this._media.isLive()?function(){return t._broker.getTimestamp()}:function(){return t._broker.getPosition()},{getMeta:function(e){return t._meta},getDuration:function(e){var n=0;return t._media.isLive()||(n=Math.floor(t._media.getLength()/1e3)),n},getPosition:function(t){return Math.floor(e()/1e3)}}},i.prototype.avPauseEvent=function(){},i.prototype.avBufferEvent=function(){},i.prototype.avEndEvent=function(){this._isPlaying=!1,this.isValidMedia()&&this.clearMedia()},i.prototype.avRewindEvent=function(){},i.prototype.avFastForwardEvent=function(){},i.prototype.avSeekEvent=function(){},i.prototype.avUserActionEvent=t,i.prototype.setMediaBufferLength=t,i.prototype.setMediaDownloadBitrate=t,i.prototype.setMediaSelectorProperties=t,i.prototype.avErrorEvent=t,i.prototype.clearMedia=function(){this.isValidMedia()&&(this._stream&&this._stream.stop(),this._stream=null,this._media=null)},i.prototype.isValidMedia=function(){return null!==this._media&&this._media.avType===a.AvType.VIDEO},i.prototype.isValidLiveMedia=function(){return this.isValidMedia()&&this._media.isLive()},i.prototype.requiresLabelCleansing=function(){return!0},i}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,s;i=[n(10),n(4),n(11),n(9)],s=function(e,t,n,i){"use strict";function s(t,i,s,o,a){this._playerDelegate=t,this._playhead=new e,this._isStarted=!1,this._interval=null,this._echoClient=s,this._broadcast=r,this._playerDelegateTimestamp=0,this._previousPosition=0,this._playingTime=0,this._media=i,this._environment=o,this._essEnabled=a,this._hb3NotSentYet=!0,this._hb5NotSentYet=!0,this._isRecievingPlayerTimestamp=!1,this._updateTime=0,this._essEnabled&&(this._schedule=new n(i,o,s))}var r="no-broadcast",o=1e3,a=1500;return s.prototype.start=function(){var e=this;this._isStarted||(this._interval=setInterval(function(){e._update()},o),this._isStarted=!0,this._isRecievingPlayerTimestamp||this._playhead.start())},s.prototype.stop=function(){clearInterval(this._interval),this._playhead.stop(),this._isStarted=!1},s.prototype._update=function(){var e,n=parseInt(this._playerDelegate.getTimestamp(),10),i=!1,s=!1,r=!1,o=this.getTimestamp(),u=new Date;u=u.getTime();var c=u-this._updateTime;this._updateTime=u,"number"==typeof n&&n>0&&(s=!0,this._isRecievingPlayerTimestamp=!0,this._playerDelegateTimestamp!==n&&(i=!0,this._echoClient.addLabel(t.MEDIA_TIMESTAMP,n)),e=n-o,s&&(0===this._playerDelegateTimestamp||e<0-c-a||e>c+a)&&(r=!0,this._playerDelegateTimestamp=n,this._playingTime+=this._playhead.getPosition(),this._restartPlayhead(),o=this.getTimestamp())),r||(0!==this._playerDelegateTimestamp&&!i||this._isRecievingPlayerTimestamp&&!s?this._playhead.stop():this._playhead.start());var l=this._updateSchedule(o);l?(this._playingTime=0,this._playerDelegateTimestamp=n,this._restartPlayhead(),this._hb3NotSentYet=!0,this._hb5NotSentYet=!0):i&&this._echoClient.releaseSuppressedPlay(),this._updateHeartbeats(),this._previousPosition=this.getPosition()},s.prototype._updateSchedule=function(e){var t,n,s,o,a=!1;return this._essEnabled&&this._schedule.hasData()&&e>0&&(t=this._schedule.getBroadcast(e),o=new i(this._media.getAvType(),this._media.getMediaConsumptionMode()),o.setServiceId(this._schedule.serviceId),t||this._broadcast===r?!t||this._broadcast!==r&&t.version.id===this._broadcast.version.id||(this._broadcast=t,n=t.published_time,s=n.end-n.start,o.setEssEnriched(!0),o.setVersionId(t.version.id),o.setLength(s),t.episode&&t.episode.id&&o.setEpisodeId(t.episode.id),this._updateMedia(o),a=!0):(this._broadcast=r,this._updateMedia(o),a=!0)),a},s.prototype._updateHeartbeats=function(){var e,t;this._broadcast!==r&&(this._hb3NotSentYet||this._hb5NotSentYet)&&(e=this._playingTime+this._playhead.getPosition(),t=this.getPosition(),e>=3e3&&this._hb3NotSentYet&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_3",t),this._hb3NotSentYet=!1),e>=5e3&&this._hb5NotSentYet&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_5",t),this._hb5NotSentYet=!1))},s.prototype._updateMedia=function(e){var t=this.getPosition();this._echoClient.liveMediaUpdate(e,t,this._previousPosition),this._previousPosition=t},s.prototype._restartPlayhead=function(){this._playhead.reset(),this._playhead.start()},s.prototype.getPosition=function(){var e;return e=this._broadcast&&this._broadcast!==r?this._playerDelegateTimestamp-this._broadcast.published_time.start+this._playhead.getPosition():this._playhead.getPosition()},s.prototype.getTimestamp=function(){return this._playerDelegateTimestamp+this._playhead.getPosition()},s}.apply(t,i),!(void 0!==s&&(e.exports=s))},function(e,t,n){var i,s;i=[n(10)],s=function(e){"use strict";function t(t,n,i){this._playerDelegate=t,this._media=n,this._echoClient=i,this._playhead=new e,this._isStarted=!1,this._interval=null,this._playerDelegatePosition=0,this._playingTime=0,this._currentIntervalMaxPosition=0,this._hb3NotSentYet=!0,this._hb5NotSentYet=!0}var n=1e3,i=1500;return t.prototype.setPlayhead=function(e){this._playhead=e},t.prototype.start=function(){var e=this;this._isStarted||(this._interval=setInterval(function(){e._update()},n),this._isStarted=!0,this._playhead.start())},t.prototype.stop=function(){clearInterval(this._interval),this._playhead.stop(),this._isStarted=!1},t.prototype.setPosition=function(e){"number"==typeof e&&e>=0&&!this.arePositionsWithinTolerance(this.getPosition(),e)&&(this._playerDelegatePosition=e,this._playingTime+=this._playhead.getPosition(),this._restartPlayhead(),this._currentIntervalMaxPosition=e)},t.prototype.getCurrentIntervalMaxPosition=function(){return this._currentIntervalMaxPosition},t.prototype._update=function(){var e=parseInt(this._playerDelegate.getPosition(),10),t=this.getPosition(),n=this._playingTime+this._playhead.getPosition();"number"==typeof e&&e!==this._playerDelegatePosition&&e>0&&(0!==this._playerDelegatePosition&&this.arePositionsWithinTolerance(e,t)||(this._playerDelegatePosition=e,t=this._playerDelegatePosition,this._restartPlayhead())),t>this._currentIntervalMaxPosition&&(this._currentIntervalMaxPosition=t),n>=3e3&&this._hb3NotSentYet&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_3",t),this._hb3NotSentYet=!1),n>=5e3&&this._hb5NotSentYet&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_5",t),this._hb5NotSentYet=!1),this._media.length>0&&t>=this._media.length&&this._echoClient.avPauseEvent(this._media.length,{echo_pause_at_media_length:1})},t.prototype._restartPlayhead=function(){this._playhead.reset(),this._playhead.start()},t.prototype.getPosition=function(){var e=this._playhead.getPosition(),t=this._playerDelegatePosition+e;return t},t.prototype.getTimestamp=function(){return 0},t.prototype.arePositionsWithinTolerance=function(e,t){var n=e-t;return n>=-i&&n<=i},t}.apply(t,i),!(void 0!==s&&(e.exports=s))},function(e,t,n){!(e.exports={STRICT:"strict",COUNTERNAME:"countername",EVENT_MASTER_BRAND:"event_master_brand",NO_CLEANSING:"no_cleansing",CUSTOM:"custom"})},function(e,t,n){var i;i=function(e){"use strict";function t(e,t){switch(e){case i.ManagedLabels.IPLAYER_STATE:if("purchased"!==t&&"free"!==t)return!1;break;case i.ManagedLabels.STORE_ED_TYPE:if("archive"!==t&&"standard"!==t)return!1;break;case i.ManagedLabels.IPLAYER_AVAIL:if("avail"!==t&&"unavail"!==t&&"soon"!==t)return!1;break;case i.ManagedLabels.STORE_REFERRAL:if("iplayer"!==t&&"store"!==t)return!1;break;case i.ManagedLabels.BBC_HASHED_ID:if("string"!=typeof t||0===s.trim(t).length)return!1}return!0}var i=n(0),s=n(1);return{isValidManagedLabel:t}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){"use strict";function e(e,t){var n=new Image;"function"==typeof t&&(n.onload=function(){t()}),n.src=e}function t(e,t){var i,s,r;s=!1,r=!1;var o=function(){s=!0,i.onload=i.onerror=i.onreadystatechange=null,i.abort()},a=function(e,n){t.onError&&t.onError(e,n)},u=function(e){s||a(e)},c=function(){var e;if(t.onSuccess){try{e=window.JSON.parse(i.responseText)}catch(e){a("json")}"object"==typeof e&&setTimeout(function(){t.onSuccess(e)})}};if(window.JSON&&window.JSON.parse&&"undefined"!=typeof window.XMLHttpRequest&&(i=new XMLHttpRequest,"withCredentials"in i&&(r=!0)),!r)return void a();try{i.open("GET",e,!0),i.onload=function(){("undefined"==typeof i.status||i.status<400)&&null!==i.responseText?c():a(i.responseText,i.status)},i.onerror=function(e){a(e)},i.timeout=n,i.ontimeout=function(e){a(e)}}catch(e){u(e)}try{i.send(null)}catch(e){o(),a(e)}}var n=1e4;return{httpGet:e,executeCrossDomainGet:t}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){e.exports=n(13)}])});
